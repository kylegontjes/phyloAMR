[{"path":"https://kylegontjes.github.io/phyloAMR/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Kyle Gontjes Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_cluster_detection.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"ancestral_state_reconstruction_cluster_detection","text":"tool’s main workhorse asr(), leverages corHMM’s ancestral state reconstruction algorithm characterize genome-influenced features’ gain, loss, continuation across phylogenetic tree. performing joint ancestral state reconstruction, resultant state predictions ancestral nodes parsed generate parent-child dataframe. traversing phylogenetic tree tips root, episodes trait gain, loss, continuation added phylogenetic tree’s edge matrix. information can leveraged infer whether isolate belonged circulating trait-containing lineage (e.g., evidence cross-transmission) resultant within-host emergence event (e.g., evidence de novo evolution). aim, provide tutorial leverage ancestral state reconstruction wrapper function, asr(), tree-traversal algorithm, asr_cluster_detection(), infer evolutionary history trait.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_cluster_detection.html","id":"environment","dir":"Articles","previous_headings":"","what":"Environment","title":"ancestral_state_reconstruction_cluster_detection","text":"","code":"library(phyloAMR) library(dplyr) #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(ggplot2) library(ape) #>  #> Attaching package: 'ape' #> The following object is masked from 'package:dplyr': #>  #>     where library(ggtree) #> ggtree v3.16.0 Learn more at https://yulab-smu.top/contribution-tree-data/ #>  #> Please cite: #>  #> Guangchuang Yu, David Smith, Huachen Zhu, Yi Guan, Tommy Tsan-Yuk Lam. #> ggtree: an R package for visualization and annotation of phylogenetic #> trees with their covariates and other associated data. Methods in #> Ecology and Evolution. 2017, 8(1):28-36. doi:10.1111/2041-210X.12628 #>  #> Attaching package: 'ggtree' #> The following object is masked from 'package:ape': #>  #>     rotate library(hues) library(ggnewscale)"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_cluster_detection.html","id":"load-example-data","dir":"Articles","previous_headings":"","what":"Load example data","title":"ancestral_state_reconstruction_cluster_detection","text":"tutorial focus emergence spread colistin non-susceptibility collection 413 carbapenem-resistant Klebsiella pneumoniae specimens collected across 12 California long-term acute care hospitals. focus evolution spread non-susceptibility colistin, last-resort antibiotic used treat Gram-negative bacteria.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_cluster_detection.html","id":"dataframe","dir":"Articles","previous_headings":"Load example data","what":"Dataframe","title":"ancestral_state_reconstruction_cluster_detection","text":"tip_name_variable: variable tip names Patient_ID: Identifiers patients study clades: clade epidemic lineage sequence type 258 isolate belongs colistin_ns: colistin non-susceptibility. 1 = non-susceptible. 0 = susceptible","code":"df <- phyloAMR::df   paste0(\"Total of 413 isolates\") #> [1] \"Total of 413 isolates\" paste0(\"Number of patients: \",length(unique(df$Patient_ID))) #> [1] \"Number of patients: 338\" dim(df) #> [1] 413   4 paste0(\"View of dataframe for first 5 isolates\") #> [1] \"View of dataframe for first 5 isolates\" head(df,n = 5) #>         tip_name_var Patient_ID    clades colistin_ns #> PCMP_H1      PCMP_H1          1 clade IIA           0 #> PCMP_H2      PCMP_H2          2 clade IIA           0 #> PCMP_H3      PCMP_H3          3 clade IIB           1 #> PCMP_H4      PCMP_H4          4 clade IIB           0 #> PCMP_H5      PCMP_H5          5   clade I           0 paste0(\"Frequency of non-susceptibility to colistin: \") #> [1] \"Frequency of non-susceptibility to colistin: \" table(df$colistin_ns) #>  #>   0   1  #> 277 136"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_cluster_detection.html","id":"phylogenetic-tree","dir":"Articles","previous_headings":"Load example data","what":"Phylogenetic tree","title":"ancestral_state_reconstruction_cluster_detection","text":"maximum-likelihood phylogenetic tree constructed Gubbins recombination filtered alignment single-nucleotide polymorphisms using IQ-TREE","code":"tr <- phyloAMR::tr ggtree(tr)"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_cluster_detection.html","id":"step-0-visualization-of-the-trait-across-the-phylogenetic-tree","dir":"Articles","previous_headings":"","what":"Step 0: Visualization of the trait across the phylogenetic tree","title":"ancestral_state_reconstruction_cluster_detection","text":"performing ancestral state reconstruction, critical visualize tip states trait phylogeny. ancestral state reconstruction clustering algorithm powerful settings frequent emergence spread trait occurs. Notice clustering Colistin non-susceptibility across phylogeny. Numerous emergence events ancestral nodes tips can visually inferred phylogeny Ancestral emergence events noticeable variations size. instance, consider large cluster non-susceptibility clade","code":"feature_colors <- c(`1` = \"black\",`0`=\"white\") feature_scale <- scale_fill_manual(values=feature_colors,labels=c(\"Present\",\"Absent\"),name=\"Tip State\", guide = guide_legend(nrow=1, title.position = \"top\", label.position = \"right\"))  p0 <- gheatmap(ggtree(tr),df %>% select(colistin_ns) %>% mutate_all(as.factor),colnames_position = 'top',width = .25,low = 'white',high='black',colnames_angle = 90,legend_title = 'Colistin non-susceptibility',hjust = 0,color = NULL) + ylim(NA,450) + feature_scale #> Scale for y is already present. #> Adding another scale for y, which will replace the existing scale. #> Scale for fill is already present. #> Adding another scale for fill, which will replace the existing scale. p0"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_cluster_detection.html","id":"step-1-run-ancestral-state-reconstruction","dir":"Articles","previous_headings":"","what":"Step 1: Run ancestral state reconstruction","title":"ancestral_state_reconstruction_cluster_detection","text":"workhorse function, asr(), used perform ancestral state reconstruction. wrapper function implements ancestral state reconstruction single rate category using corHMM R package: https://github.com/thej022214/corHMM Using inferred ancestral states tip-based data, edges phylogenetic tree evaluated determine episodes trait continued (.e., susceptible -> susceptible non-susceptible -> non-susceptible), gained (.e., susceptible -> non-susceptible), lost (.e., non-susceptible -> susceptible). edge matrix can leveraged numerous applications, including characterizing frequency trait transitions across phylogeny investigating phenotype-genotype associations. following parameters exist function df: Dataframe tip name variable (e.g., tip_name_variable) trait variable (e.g., colistin_ns) tr: Phylogenetic tree object class phylo model: approach permits use either equal rates (ER) rates differ (ARD) transition matrices. Equal rates: Assumes equal transition rates trait gain (e.g., trait absence -> presence) loss (e.g., trait gain -> absence) rates differ: Assumes different transition rates trait gain loss node_states: Whether perform ‘joint’ ‘marginal’ ancestral state reconstruction experience, recommend using joint ancestral state reconstruction.","code":"asr_obj <- phyloAMR::asr(df = df,tr = tr,tip_name_variable = \"tip_name_var\",trait = \"colistin_ns\",model = \"ER\",node_states = \"joint\") #> You specified 'fixed.nodes=FALSE' but included a phy object with node labels. These node labels have been removed. #> State distribution in data: #> States:  0   1    #> Counts:  277 136  #> Beginning thorough optimization search -- performing 0 random restarts  #> Finished. Inferring ancestral states using joint reconstruction.  paste0(\"Output names: \") #> [1] \"Output names: \" names(asr_obj) #> [1] \"corHMM_output\"           \"corHMM_model_statistics\" #> [3] \"parent_child_df\"         \"node_states\"  paste0(\"corHMM_out: output from ancestral state reconstruction algorithm hosted in the R package corHMM\") #> [1] \"corHMM_out: output from ancestral state reconstruction algorithm hosted in the R package corHMM\" asr_obj$corHMM_out #>  #> Fit #>        lnL      AIC    AICc Rate.cat ntax #>  -177.9706 357.9413 357.951        1  413 #>  #> Legend #> [1] \"colistin_ns\" #> [1] \"0\" \"1\" #>  #> Rates #>         0       1 #> 0      NA 89515.8 #> 1 89515.8      NA #>  #> Arrived at a reliable solution  paste0(\"corHMM_model_summary: A summary of the corHMM model, including the number of parameters, model, number of rate categories, inferred transition rates, log likelihood, AIC, and AICc\") #> [1] \"corHMM_model_summary: A summary of the corHMM model, including the number of parameters, model, number of rate categories, inferred transition rates, log likelihood, AIC, and AICc\" paste0(\"Rate 1 = transitions from level 1 (i.e., susceptible) to level 2 (i.e., non-susceptible)\") #> [1] \"Rate 1 = transitions from level 1 (i.e., susceptible) to level 2 (i.e., non-susceptible)\" paste0(\"Rate 2 = transitions from level 2 (i.e., non-susceptible) to level 1 (i.e., susceptible)\") #> [1] \"Rate 2 = transitions from level 2 (i.e., non-susceptible) to level 1 (i.e., susceptible)\" asr_obj$corHMM_model_summary #> NULL  paste0(\"node_states: Chosen node state that was modeled.\") #> [1] \"node_states: Chosen node state that was modeled.\" asr_obj$node_states #> [1] \"joint\"  paste0(\"parent_child_df: Parent child dataframe, which contains the edge dataset, parent and child values, the child name (for tips), and transition data (i.e., gain, loss, and continuation of the trait on tree or continuation of trait absence on tree)\") #> [1] \"parent_child_df: Parent child dataframe, which contains the edge dataset, parent and child values, the child name (for tips), and transition data (i.e., gain, loss, and continuation of the trait on tree or continuation of trait absence on tree)\" head(asr_obj$parent_child_df) #>   parent child parent_value child_value child_name transition gain loss #> 1    414   415            0           0       <NA>          0    0    0 #> 2    415   416            0           0       <NA>          0    0    0 #> 3    416   417            0           0       <NA>          0    0    0 #> 4    417   418            0           1       <NA>          1    1    0 #> 5    418   419            1           1       <NA>          0    0    0 #> 6    419   420            1           1       <NA>          0    0    0 #>   continuation continuation_present continuation_absent #> 1            1                    0                   1 #> 2            1                    0                   1 #> 3            1                    0                   1 #> 4            0                    0                   0 #> 5            1                    1                   0 #> 6            1                    1                   0"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_cluster_detection.html","id":"step-2-characterize-the-transition-statistics-for-the-trait-across-the-phylogeny","dir":"Articles","previous_headings":"","what":"Step 2: Characterize the transition statistics for the trait across the phylogeny","title":"ancestral_state_reconstruction_cluster_detection","text":"frequency location trait gain, loss, continuation events can characterized using asr_transition_analysis() function case, several important observations occur: 824 edges, 48 contained transition events: 37 gain events 11 loss events 30/37 gain events 7/11 loss events indicative emergence spread colistin non-susceptible strains population also provide frequency statistics gain, loss, continuation traits can useful characterize transition dynamics trait:","code":"asr_transition_analysis(asr_obj$parent_child_df, node_states='joint') #>   total_edges transitions gains gains_tip losses losses_tip continuations #> 1         824          48    37        30     11          7           776 #>   continuations_present continuations_absent gain_frequency loss_frequency #> 1                   209                  567           6.13              5 #>   continuation_present_frequency continuation_absent_frequency #> 1                          25.36                         68.81"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_cluster_detection.html","id":"step-3-cluster-detection","dir":"Articles","previous_headings":"","what":"Step 3: Cluster detection","title":"ancestral_state_reconstruction_cluster_detection","text":"Given numerous gain loss events, well-positioned leverage tree traversal algorithm infer evolutionary history isolates. package, developed phylogenetic tree traversal algorithm, asr_cluster_detection(), traces ancestral states isolate infer evolutionary history. algorithm takes isolate’s trait data walks upward tree classify trait-containing isolates phylogenetic singletons (.e., evidence de novo evolution) members phylogenetic cluster trait (.e., evidence acquisition circulating trait-containing lineage). Extending study Colistin non-susceptibility, non-susceptible isolates gain events inferred tip classified phylogenetic singletons. However, instances non-susceptible isolate gain event tip reversion event parental node eligible classification members phylogenetic cluster. Non-susceptible isolates classified members phylogenetic cluster ancestral gain event shared least one additional resistant isolate. Non-susceptible isolates share ancestral gain event resistant isolate classified phylogenetic singletons. Phylogenetic clusters isolates belonged one patient considered clusters reclassified redundant phylogenetic singletons.  following parameters exist function: df: Dataframe tip name variable (e.g., tip_name_variable) trait variable (e.g., colistin_ns) tr: Phylogenetic tree object class phylo tip_name_variable: Tip name variable patient_id: Variable pertaining patient identifier pheno: Phenotype interest (e.g., colistin non-susceptibility) parent_child_df: parent child dataframe (e.g., edge matrix) node_states: Node states ancestral state reconstruction model confidence: MARGINAL RECONSTRUCTION, . Whether consider ‘high’ confidence events (e.g., absent present) ‘low’ confidence transition events (e.g., absent unsure). recommend using ‘high’ confidence transition events. faux_clusters: Whether ‘remove’ (e.g., reclassify singletons) ‘rename’ (e.g., classify faux) clusters isolates belong just one patient. important consider classifying clusters phenotype remove_reverant: Whether remove (TRUE) episodes trait reversion (e.g., present -> absent) permit labeled collapse_cluster: Whether collapse (TRUE) episodes either cluster, singleton, feature","code":"asr_cluster_obj <- asr_cluster_detection(df = df,tr=tr,tip_name_variable = \"tip_name_var\",patient_id = 'PatientID',parent_child_df = asr_obj$parent_child_df,node_states = 'joint',confidence = NULL, simplify_faux_clusters = FALSE, simplify_revertant = TRUE, collapse_cluster = TRUE)  paste0(\"Cluster detection dataframe\") #> [1] \"Cluster detection dataframe\" colnames(asr_cluster_obj) #>  [1] \"parent\"                \"child\"                 \"parent_value\"          #>  [4] \"child_value\"           \"child_name\"            \"transition\"            #>  [7] \"gain\"                  \"loss\"                  \"continuation\"          #> [10] \"continuation_present\"  \"continuation_absent\"   \"tip_name\"              #> [13] \"asr_cluster\"           \"asr_cluster_renamed\"   \"asr_cluster_collapsed\" head(asr_cluster_obj,n=5) #>           parent child parent_value child_value child_name transition gain loss #> PCMP_H325    432     1            1           1  PCMP_H325          0    0    0 #> PCMP_H411    432     2            1           1  PCMP_H411          0    0    0 #> PCMP_H213    434     3            1           1  PCMP_H213          0    0    0 #> PCMP_H286    435     4            1           1  PCMP_H286          0    0    0 #> PCMP_H387    435     5            1           1  PCMP_H387          0    0    0 #>           continuation continuation_present continuation_absent  tip_name #> PCMP_H325            1                    1                   0 PCMP_H325 #> PCMP_H411            1                    1                   0 PCMP_H411 #> PCMP_H213            1                    1                   0 PCMP_H213 #> PCMP_H286            1                    1                   0 PCMP_H286 #> PCMP_H387            1                    1                   0 PCMP_H387 #>           asr_cluster asr_cluster_renamed asr_cluster_collapsed #> PCMP_H325 cluster_418           Cluster 1               Cluster #> PCMP_H411 cluster_418           Cluster 1               Cluster #> PCMP_H213 cluster_418           Cluster 1               Cluster #> PCMP_H286 cluster_418           Cluster 1               Cluster #> PCMP_H387 cluster_418           Cluster 1               Cluster  paste0(\"asr_cluster: raw clustering data. The numbers for cluster and revertant lineages correspond to the ancestral node where the shared gain (i.e., cluster_527) or loss (e.g., revertant_782) event occured.\") #> [1] \"asr_cluster: raw clustering data. The numbers for cluster and revertant lineages correspond to the ancestral node where the shared gain (i.e., cluster_527) or loss (e.g., revertant_782) event occured.\" table(asr_cluster_obj$asr_cluster) #>  #>           cluster_418           cluster_527           cluster_533  #>                    72                     2                    12  #>           cluster_551           cluster_574           cluster_647  #>                     2                     8                     4  #>           cluster_775            no feature revertant_cluster_464  #>                     6                   236                     2  #> revertant_cluster_476 revertant_cluster_583 revertant_cluster_782  #>                    15                    15                     2  #>         revertant_tip             singleton  #>                     7                    30  paste0(\"asr_cluster_renamed: Renamed these categories as singleton, cluster X, and no feature\") #> [1] \"asr_cluster_renamed: Renamed these categories as singleton, cluster X, and no feature\" table(asr_cluster_obj$asr_cluster_renamed) #>  #>  Cluster 1  Cluster 2  Cluster 3  Cluster 4  Cluster 5  Cluster 6  Cluster 7  #>         72          2         12          2          4          8          6  #> No feature  Singleton  #>        277         30  paste0(\"asr_cluster_collapsed: Collapsed as singleton, cluster, or no feature\") #> [1] \"asr_cluster_collapsed: Collapsed as singleton, cluster, or no feature\" table(asr_cluster_obj$asr_cluster_collapsed) #>  #>    Cluster No feature  Singleton  #>        106        277         30"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_cluster_detection.html","id":"step-4-cluster-statistics","dir":"Articles","previous_headings":"","what":"Step 4: Cluster statistics","title":"ancestral_state_reconstruction_cluster_detection","text":"characterize evolutionary history, described transitional data phylogenetic clustering antibiotic phenotype. Descriptive statistics phylogenetic clustering can determined using phyloAMR’s asr_cluster_analysis() function. Specifically, crude frequency trait, descriptive statistics number singletons, clusters, summary statistics cluster size. use two measures characterize phylogenetics trait: phylogenetic occurrence (Equation 1) clustering (Equation 2).  Phylogenetic frequency: . singleton events + . clustersNo. singleton events + . clusters + . isolates without feature Clustering frequency: . clustersNo. singleton events + . clusters  ","code":"asr_cluster_analysis(asr_cluster_obj) #>   present singletons singleton_isolates clusters cluster_isolates #> 1     136         30                 30        7              106 #>   cluster_size_median cluster_size_mean cluster_size_range no_feature #> 1                   6             15.14               2-72        277 #>   revertant_isolates revertant_clusters revertant_cluster_size_median #> 1                 41                  4                           8.5 #>   revertant_cluster_size_mean revertant_cluster_size_range phylogenetic_events #> 1                         8.5                         2-15                  37 #>   feature_frequency phylogenetic_frequency clustering_frequency #> 1             32.93                   7.41                18.92"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_cluster_detection.html","id":"step-5-visualize-clusters-on-phylogeny","dir":"Articles","previous_headings":"","what":"Step 5: Visualize clusters on phylogeny","title":"ancestral_state_reconstruction_cluster_detection","text":"Finally, critical inspect lineages phylogeny. tour phylogeny: White indicates susceptibility Red indicates non-susceptible isolate gain inferred tip Faux clusters (e.g., phylogenetic clusters one patient) also relabeled red colors correspond seven clusters Colistin non-susceptibility present population visualization permits inspection cluster calls characterize phylogenetic clustering trait using ancestral state reconstruction","code":"# Cluster color pallete ## Number of clusters ncluster <- table(asr_cluster_obj$asr_cluster)  %>% subset(names(.) != \"singleton\" & !grepl(\"1pt\",names(.)) & grepl(\"cluster\",names(.))) %>% as.numeric %>%length  ## Cluster pallete color_palette <- grDevices::colors() %>% subset(grepl(\"red\",.)==F) clusters_col <- hues::iwanthue(ncluster,hmin=15,hmax=360,lmin = 5,lmax = 95,cmin=5,cmax=90,random = F,plot = F) ## Names clusters_name <- paste0(\"Cluster \",1:ncluster) names(clusters_col) <- clusters_name ## Scale cluster_scale <- scale_fill_manual(breaks =c(\"No feature\",\"Singleton\",\"Single atient Cluter\",names(clusters_col)),values=c(\"No feature\" = \"white\",\"Singleton\" = \"red\",\"Single patient cluster\" = 'gray',clusters_col),labels=c(\"No Feature\",\"NS Singleton\",\"NS Single Patient Cluster\",clusters_name),name=\"Phylogenetics of Non-susceptibility\", guide = guide_legend(ncol=4, title.position = \"top\", label.position = \"right\"))  # Phylogenetic visualization p0.1 <- p0+ggnewscale::new_scale_fill() gheatmap(p0.1,asr_cluster_obj %>% select(asr_cluster_renamed) %>% mutate_all(as.factor),colnames_position = 'top',width = .25,colnames_angle = 90,legend_title = 'Colistin non-usceptibility',hjust = 0,offset=0.0000075,color=NULL) + ylim(NA,500) + cluster_scale #> Scale for y is already present. #> Adding another scale for y, which will replace the existing scale. #> Scale for fill is already present. #> Adding another scale for fill, which will replace the existing scale."},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_of_a_trait.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"ancestral_state_reconstruction_of_a_trait","text":"tool’s main workhorse asr(), leverages corHMM’s ancestral state reconstruction algorithm characterize genome-influenced features’ gain, loss, continuation across phylogenetic tree. performing joint ancestral state reconstruction, state predictions ancestral nodes parsed generate parent-child dataframe. traversing phylogenetic tree tips root, episodes trait gain, loss, continuation added phylogenetic tree’s edge matrix. information can leveraged, using downstream algorithms, address numerous biological questions, including: often regime genome-informed trait emerge spread across healthcare network? evidence synchronous gain/loss traits phylogenetic tree? compensatory revertant mutations follow genome-informed trait?","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_of_a_trait.html","id":"environment","dir":"Articles","previous_headings":"","what":"Environment","title":"ancestral_state_reconstruction_of_a_trait","text":"","code":"library(phyloAMR) library(dplyr) #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(stringr) library(ggplot2) library(ape) #>  #> Attaching package: 'ape' #> The following object is masked from 'package:dplyr': #>  #>     where library(ggtree) #> ggtree v3.16.0 Learn more at https://yulab-smu.top/contribution-tree-data/ #>  #> Please cite: #>  #> Guangchuang Yu, David Smith, Huachen Zhu, Yi Guan, Tommy Tsan-Yuk Lam. #> ggtree: an R package for visualization and annotation of phylogenetic #> trees with their covariates and other associated data. Methods in #> Ecology and Evolution. 2017, 8(1):28-36. doi:10.1111/2041-210X.12628 #>  #> Attaching package: 'ggtree' #> The following object is masked from 'package:ape': #>  #>     rotate library(corHMM) #> Loading required package: nloptr #> Loading required package: GenSA"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_of_a_trait.html","id":"load-example-data","dir":"Articles","previous_headings":"","what":"Load example data","title":"ancestral_state_reconstruction_of_a_trait","text":"tutorial focus emergence spread colistin non-susceptibility collection 413 carbapenem-resistant Klebsiella pneumoniae specimens collected across 12 California long-term acute care hospitals. focus evolution spread non-susceptibility colistin, last-resort antibiotic used treat Gram-negative bacteria.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_of_a_trait.html","id":"dataframe","dir":"Articles","previous_headings":"Load example data","what":"Dataframe","title":"ancestral_state_reconstruction_of_a_trait","text":"tip_name_variable: variable tip names Patient_ID: Identifiers patients study clades: clade epidemic lineage sequence type 258 isolate belongs colistin_ns: colistin non-susceptibility. 1 = non-susceptible. 0 = susceptible","code":"df <- phyloAMR::df    paste0(\"Adjust rownames\") #> [1] \"Adjust rownames\" df<- df %>% .[match(tr$tip.label,.[['tip_name_var']]),]  paste0(\"Total of 413 isolates\") #> [1] \"Total of 413 isolates\"  paste0(\"Number of patients: \",length(unique(df$Patient_ID))) #> [1] \"Number of patients: 338\" dim(df) #> [1] 413   4  paste0(\"View of dataframe for first 5 isolates\") #> [1] \"View of dataframe for first 5 isolates\" head(df,n = 5) #>           tip_name_var Patient_ID    clades colistin_ns #> PCMP_H325    PCMP_H325        279 clade IIB           1 #> PCMP_H411    PCMP_H411        279 clade IIB           1 #> PCMP_H213    PCMP_H213        189 clade IIB           1 #> PCMP_H286    PCMP_H286        249 clade IIB           1 #> PCMP_H387    PCMP_H387        249 clade IIB           1  paste0(\"Frequency of non-susceptibility to colistin: \")  #> [1] \"Frequency of non-susceptibility to colistin: \" table(df$colistin_ns) #>  #>   0   1  #> 277 136"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_of_a_trait.html","id":"phylogenetic-tree","dir":"Articles","previous_headings":"Load example data","what":"Phylogenetic tree","title":"ancestral_state_reconstruction_of_a_trait","text":"maximum-likelihood phylogenetic tree constructed Gubbins recombination filtered alignment single-nucleotide polymorphisms using IQ-TREE","code":"tr <- phyloAMR::tr ggtree(tr)"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_of_a_trait.html","id":"step-0-visualization-of-the-trait-across-the-phylogenetic-tree","dir":"Articles","previous_headings":"","what":"Step 0: Visualization of the trait across the phylogenetic tree","title":"ancestral_state_reconstruction_of_a_trait","text":"performing ancestral state reconstruction, critical visualize tip states trait phylogeny. ancestral state reconstruction clustering algorithm powerful settings frequent emergence spread trait occurs. Notice clustering Colistin non-susceptibility across phylogeny. Numerous emergence events ancestral nodes tips can visually inferred phylogeny Ancestral emergence events noticeable variations size. instance, consider large cluster non-susceptibility clade","code":"feature_colors <- c(`1` = \"black\",`0`=\"white\") feature_scale <- scale_fill_manual(values=feature_colors,labels=c(\"Present\",\"Absent\"),name=\"Tip State\", guide = guide_legend(nrow=1, title.position = \"top\", label.position = \"right\"))  p0 <- gheatmap(ggtree(tr),df %>% select(colistin_ns) %>% mutate_all(as.factor),colnames_position = 'top',width = .25,low = 'white',high='black',colnames_angle = 90,legend_title = 'Colistin non-susceptibility',hjust = 0,color = NULL) + ylim(NA,485) + feature_scale #> Scale for y is already present. #> Adding another scale for y, which will replace the existing scale. #> Scale for fill is already present. #> Adding another scale for fill, which will replace the existing scale. p0"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_of_a_trait.html","id":"step-1-run-ancestral-state-reconstruction","dir":"Articles","previous_headings":"","what":"Step 1: Run ancestral state reconstruction","title":"ancestral_state_reconstruction_of_a_trait","text":"workhorse function, asr(), used perform ancestral state reconstruction. wrapper function implements ancestral state reconstruction single rate category using corHMM R package: https://github.com/thej022214/corHMM Using inferred ancestral states tip-based data, edges phylogenetic tree evaluated determine episodes trait continued (.e., susceptible -> susceptible non-susceptible -> non-susceptible), gained (.e., susceptible -> non-susceptible), lost (.e., non-susceptible -> susceptible). edge matrix can leveraged numerous applications, including characterizing frequency trait transitions across phylogeny investigating phenotype-genotype associations. following parameters exist function df: Dataframe tip name variable (e.g., tip_name_variable) trait variable (e.g., colistin_ns) tr: Phylogenetic tree object class phylo model: approach permits use either equal rates (ER) rates differ (ARD) transition matrices. Equal rates: Assumes equal transition rates trait gain (e.g., trait absence -> presence) loss (e.g., trait gain -> absence) rates differ: Assumes different transition rates trait gain loss node_states: Whether perform ‘joint’ ‘marginal’ ancestral state reconstruction experience, recommend using joint ancestral state reconstruction.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_of_a_trait.html","id":"aside-determining-the-best-model","dir":"Articles","previous_headings":"Step 1: Run ancestral state reconstruction","what":"Aside: Determining the best model","title":"ancestral_state_reconstruction_of_a_trait","text":"suggest use equal rates (ER) transition matrix chosen model corHMM, instances permit modeling trait using rates differ (ARD) model. implemented function called, find_best_asr_model(), performs ancestral state reconstruction using ER ARD model. Next, best model chosen using Akaike information criteria (AIC). Specifically, model lowest AIC chosen. asr() function option run model finding algorithm using model = “MF” argument.","code":"best_model_obj <- phyloAMR::find_best_asr_model(df = df,tr = tr,tip_name_variable = \"tip_name_var\",trait = 'colistin_ns',node_states = 'joint') #> Testing equal rates (ER) model  #> You specified 'fixed.nodes=FALSE' but included a phy object with node labels. These node labels have been removed. #> State distribution in data: #> States:  0   1    #> Counts:  277 136  #> Beginning thorough optimization search -- performing 0 random restarts  #> Finished. Inferring ancestral states using joint reconstruction.  #> AICc of ER model is: 357.950996595162  #> Testing all rates differ (ARD) model  #> You specified 'fixed.nodes=FALSE' but included a phy object with node labels. These node labels have been removed. #> State distribution in data: #> States:  0   1    #> Counts:  277 136  #> Beginning thorough optimization search -- performing 0 random restarts  #> Finished. Inferring ancestral states using joint reconstruction.  #> AICc of ARD model is: 355.966418109559  #> Best model: ARD  paste0(\"Model fit statistics: \") #> [1] \"Model fit statistics: \" best_model_obj$model_options #> NULL  paste0(\"Best model: \") #> [1] \"Best model: \" best_model_obj$best_model #> [1] \"ARD\""},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_of_a_trait.html","id":"running-ancestral-state-reconstruction","dir":"Articles","previous_headings":"Step 1: Run ancestral state reconstruction","what":"Running ancestral state reconstruction","title":"ancestral_state_reconstruction_of_a_trait","text":"","code":"asr_obj <- phyloAMR::asr(df = df,tr = tr,tip_name_variable = \"tip_name_var\",trait = \"colistin_ns\",model = \"ER\",node_states = \"joint\") #> You specified 'fixed.nodes=FALSE' but included a phy object with node labels. These node labels have been removed. #> State distribution in data: #> States:  0   1    #> Counts:  277 136  #> Beginning thorough optimization search -- performing 0 random restarts  #> Finished. Inferring ancestral states using joint reconstruction.  paste0(\"Output names: \") #> [1] \"Output names: \" names(asr_obj) #> [1] \"corHMM_output\"           \"corHMM_model_statistics\" #> [3] \"parent_child_df\"         \"node_states\"  paste0(\"corHMM_out: output from ancestral state reconstruction algorithm hosted in the R package corHMM\") #> [1] \"corHMM_out: output from ancestral state reconstruction algorithm hosted in the R package corHMM\" asr_obj$corHMM_out #>  #> Fit #>        lnL      AIC    AICc Rate.cat ntax #>  -177.9706 357.9413 357.951        1  413 #>  #> Legend #> [1] \"colistin_ns\" #> [1] \"0\" \"1\" #>  #> Rates #>          0        1 #> 0       NA 89553.08 #> 1 89553.08       NA #>  #> Arrived at a reliable solution  paste0(\"corHMM_model_summary: A summary of the corHMM model, including the number of parameters, model, number of rate categories, inferred transition rates, log likelihood, AIC, and AICc\") #> [1] \"corHMM_model_summary: A summary of the corHMM model, including the number of parameters, model, number of rate categories, inferred transition rates, log likelihood, AIC, and AICc\" paste0(\"Rate 1 = transitions from level 1 (i.e., susceptible) to level 2 (i.e., non-susceptible)\") #> [1] \"Rate 1 = transitions from level 1 (i.e., susceptible) to level 2 (i.e., non-susceptible)\" paste0(\"Rate 2 = transitions from level 2 (i.e., non-susceptible) to level 1 (i.e., susceptible)\") #> [1] \"Rate 2 = transitions from level 2 (i.e., non-susceptible) to level 1 (i.e., susceptible)\" asr_obj$corHMM_model_summary #> NULL  paste0(\"node_states: Chosen node state that was modeled.\") #> [1] \"node_states: Chosen node state that was modeled.\" asr_obj$node_states #> [1] \"joint\"  paste0(\"parent_child_df: Parent child dataframe, which contains the edge dataset, parent and child values, the child name (for tips), and transition data (i.e., gain, loss, and continuation of the trait on tree or continuation of trait absence on tree)\") #> [1] \"parent_child_df: Parent child dataframe, which contains the edge dataset, parent and child values, the child name (for tips), and transition data (i.e., gain, loss, and continuation of the trait on tree or continuation of trait absence on tree)\" head(asr_obj$parent_child_df) #>   parent child parent_value child_value child_name transition gain loss #> 1    414   415            0           0       <NA>          0    0    0 #> 2    415   416            0           0       <NA>          0    0    0 #> 3    416   417            0           0       <NA>          0    0    0 #> 4    417   418            0           1       <NA>          1    1    0 #> 5    418   419            1           1       <NA>          0    0    0 #> 6    419   420            1           1       <NA>          0    0    0 #>   continuation continuation_present continuation_absent #> 1            1                    0                   1 #> 2            1                    0                   1 #> 3            1                    0                   1 #> 4            0                    0                   0 #> 5            1                    1                   0 #> 6            1                    1                   0"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_of_a_trait.html","id":"step-2-describe-the-model-e-g--rates-and-fit","dir":"Articles","previous_headings":"","what":"Step 2: Describe the model (e.g., rates and fit)","title":"ancestral_state_reconstruction_of_a_trait","text":"function, characterize_asr_model(), can leveraged corHMM output identify inferred rates model fit statistics (.e., log likelihood AIC values)","code":"phyloAMR::characterize_asr_model(asr_obj$corHMM_out) #>   model number_parameters number_rate_categories    rate1 rate2    loglik #> 1    ER                 1                      1 89553.08    NA -177.9706 #>        AIC    AICc #> 1 357.9413 357.951"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_of_a_trait.html","id":"step-3-characterize-the-transition-statistics-for-the-trait-across-the-phylogeny","dir":"Articles","previous_headings":"","what":"Step 3: Characterize the transition statistics for the trait across the phylogeny","title":"ancestral_state_reconstruction_of_a_trait","text":"frequency location trait gain, loss, continuation events can characterized using asr_transition_analysis() function case, several important observations occur: 824 edges, 48 contained transition events: 37 gain events 11 loss events 30/37 gain events 7/11 loss events indicative emergence spread colistin non-susceptible strains population also provide frequency statistics gain, loss, continuation traits can useful characterize transition dynamics trait:","code":"asr_transition_analysis(asr_obj$parent_child_df,node_states='joint') #>   total_edges transitions gains gains_tip losses losses_tip continuations #> 1         824          48    38        31     10          7           776 #>   continuations_present continuations_absent gain_frequency loss_frequency #> 1                   206                  570           6.25           4.63 #>   continuation_present_frequency continuation_absent_frequency #> 1                             25                         69.17"},{"path":[]},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_of_a_trait.html","id":"paint-the-tree","dir":"Articles","previous_headings":"Step 4: Paint the states on the phylogeny","what":"Paint the tree","title":"ancestral_state_reconstruction_of_a_trait","text":"","code":"painted_tree <- phyloAMR::paint_tree_with_states(asr_obj$parent_child_df,tr) #> Joining with `by = join_by(node)` painted_tree"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_of_a_trait.html","id":"add-non-suceptibility-matrix-to-the-painted-tree","dir":"Articles","previous_headings":"Step 4: Paint the states on the phylogeny","what":"Add non-suceptibility matrix to the painted tree","title":"ancestral_state_reconstruction_of_a_trait","text":"","code":"gheatmap(painted_tree,df %>% select(colistin_ns) %>% mutate_all(as.factor),colnames_position = 'top',width = .25,low = 'white',high='black',colnames_angle = 90,legend_title = 'Colistin non-susceptibility',hjust = 0,color = NULL) + ylim(NA,485) + feature_scale #> Scale for y is already present. #> Adding another scale for y, which will replace the existing scale. #> Scale for fill is already present. #> Adding another scale for fill, which will replace the existing scale."},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_of_a_trait.html","id":"whats-next","dir":"Articles","previous_headings":"","what":"What’s next?","title":"ancestral_state_reconstruction_of_a_trait","text":"algorithm can leveraged ask numerous questions. Specifically, build following functions address questions interest:","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_phenotype_genotype_investigations.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Phenotype and genotype association testing using ancestral state reconstruction","text":"tool’s main workhorse asr(), leverages corHMM’s ancestral state reconstruction algorithm characterize genome-influenced features’ gain, loss, continuation across phylogenetic tree. performing joint ancestral state reconstruction, resultant state predictions ancestral nodes parsed generate parent-child dataframe. traversing phylogenetic tree tips root, episodes trait gain, loss, continuation added phylogenetic tree’s edge matrix. information can leveraged infer whether genotype associated phenotype. wrote two functions assess : 1. synchronous_transitions(): Detection synchronous genotype-phenotype transitions 2. downstream_transitions(): Detection downstream genotype gain/loss events phenotypic stretches","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_phenotype_genotype_investigations.html","id":"environment","dir":"Articles","previous_headings":"","what":"Environment","title":"Phenotype and genotype association testing using ancestral state reconstruction","text":"","code":"library(phyloAMR) library(dplyr) #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(stringr) library(ggplot2) library(ape) #>  #> Attaching package: 'ape' #> The following object is masked from 'package:dplyr': #>  #>     where library(ggtree)  #> ggtree v3.16.0 Learn more at https://yulab-smu.top/contribution-tree-data/ #>  #> Please cite: #>  #> Guangchuang Yu, David Smith, Huachen Zhu, Yi Guan, Tommy Tsan-Yuk Lam. #> ggtree: an R package for visualization and annotation of phylogenetic #> trees with their covariates and other associated data. Methods in #> Ecology and Evolution. 2017, 8(1):28-36. doi:10.1111/2041-210X.12628 #>  #> Attaching package: 'ggtree' #> The following object is masked from 'package:ape': #>  #>     rotate"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_phenotype_genotype_investigations.html","id":"load-example-data","dir":"Articles","previous_headings":"","what":"Load example data","title":"Phenotype and genotype association testing using ancestral state reconstruction","text":"tutorial focus emergence spread colistin non-susceptibility collection 413 carbapenem-resistant Klebsiella pneumoniae specimens collected across 12 California long-term acute care hospitals. focus evolution spread non-susceptibility colistin, last-resort antibiotic used treat Gram-negative bacteria.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_phenotype_genotype_investigations.html","id":"dataframe","dir":"Articles","previous_headings":"Load example data","what":"Dataframe","title":"Phenotype and genotype association testing using ancestral state reconstruction","text":"tip_name_variable: variable tip names Patient_ID: Identifiers patients study clades: clade epidemic lineage sequence type 258 isolate belongs colistin_ns: colistin non-susceptibility. 1 = non-susceptible. 0 = susceptible","code":"df <- phyloAMR::df   paste0(\"Total of 413 isolates\") #> [1] \"Total of 413 isolates\" paste0(\"Number of patients: \",length(unique(df$Patient_ID))) #> [1] \"Number of patients: 338\" dim(df) #> [1] 413   4 paste0(\"View of dataframe for first 5 isolates\") #> [1] \"View of dataframe for first 5 isolates\" head(df,n = 5) #>         tip_name_var Patient_ID    clades colistin_ns #> PCMP_H1      PCMP_H1          1 clade IIA           0 #> PCMP_H2      PCMP_H2          2 clade IIA           0 #> PCMP_H3      PCMP_H3          3 clade IIB           1 #> PCMP_H4      PCMP_H4          4 clade IIB           0 #> PCMP_H5      PCMP_H5          5   clade I           0 paste0(\"Frequency of non-susceptibility to colistin: \") #> [1] \"Frequency of non-susceptibility to colistin: \" table(df$colistin_ns) #>  #>   0   1  #> 277 136"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_phenotype_genotype_investigations.html","id":"phylogenetic-tree","dir":"Articles","previous_headings":"Load example data","what":"Phylogenetic tree","title":"Phenotype and genotype association testing using ancestral state reconstruction","text":"maximum-likelihood phylogenetic tree constructed Gubbins recombination filtered alignment single-nucleotide polymorphisms using IQ-TREE","code":"tr <- phyloAMR::tr ggtree(tr)"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_phenotype_genotype_investigations.html","id":"step-0-1-visualization-of-the-trait-across-the-phylogenetic-tree","dir":"Articles","previous_headings":"","what":"Step 0.1: Visualization of the trait across the phylogenetic tree","title":"Phenotype and genotype association testing using ancestral state reconstruction","text":"performing ancestral state reconstruction, critical visualize tip states trait phylogeny. ancestral state reconstruction clustering algorithm powerful settings frequent emergence spread trait occurs. Notice clustering Colistin non-susceptibility across phylogeny. Numerous emergence events ancestral nodes tips can visually inferred phylogeny Ancestral emergence events noticeable variations size. instance, consider large cluster non-susceptibility clade","code":"feature_colors <- c(`1` = \"black\",`0`=\"white\") feature_scale <- scale_fill_manual(values=feature_colors,labels=c(\"Present\",\"Absent\"),name=\"Tip State\", guide = guide_legend(nrow=1, title.position = \"top\", label.position = \"right\"))  p0 <- gheatmap(ggtree(tr),df %>% select(colistin_ns) %>% mutate_all(as.factor),colnames_position = 'top',width = .25,low = 'white',high='black',colnames_angle = 90,legend_title = 'Colistin non-susceptibility',hjust = 0,color = NULL) + ylim(NA,485) + feature_scale #> Scale for y is already present. #> Adding another scale for y, which will replace the existing scale. #> Scale for fill is already present. #> Adding another scale for fill, which will replace the existing scale. p0"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_phenotype_genotype_investigations.html","id":"step-0-2-visualization-of-the-genotypes-across-the-phylogenetic-tree","dir":"Articles","previous_headings":"","what":"Step 0.2: Visualization of the genotypes across the phylogenetic tree","title":"Phenotype and genotype association testing using ancestral state reconstruction","text":"provide genotypes associated colistin non-susceptibility. can leveraged demonstrate genotype-phenotype algorithms developed package.","code":"genotype_mat <- phyloAMR::genotype_mat  paste0(\"Total of \",ncol(genotype_mat),\" genotypes\") #> [1] \"Total of 76 genotypes\"   paste0(\"Genotypes present in this matrix: \") #> [1] \"Genotypes present in this matrix: \" colnames(genotype_mat) #>  [1] \"Coding SNP at 3359989 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;T|stop_gained|HIGH|KPNIH1_RS30220|c.141G>A|p.Trp47*|141/144|47/47|mgrB|PhoP/PhoQ regulator MgrB;_68746\"                                                                                                  #>  [2] \"Coding SNP at 3360003 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;A|stop_gained|HIGH|KPNIH1_RS30220|c.127A>T|p.Lys43*|127/144|43/47|mgrB|PhoP/PhoQ regulator MgrB;_68748\"                                                                                                  #>  [3] \"Coding SNP at 3360042 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;A|stop_gained|HIGH|KPNIH1_RS30220|c.88C>T|p.Gln30*|88/144|30/47|mgrB|PhoP/PhoQ regulator MgrB;_68751\"                                                                                                    #>  [4] \"Coding SNP at 3360066 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;A|stop_gained|HIGH|KPNIH1_RS30220|c.64C>T|p.Gln22*|64/144|22/47|mgrB|PhoP/PhoQ regulator MgrB;_68754\"                                                                                                    #>  [5] \"Coding SNP at 3360123 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;A|stop_gained|HIGH|KPNIH1_RS30220|c.7A>T|p.Lys3*|7/144|3/47|mgrB|PhoP/PhoQ regulator MgrB;_68758\"                                                                                                        #>  [6] \"Coding Indel at 3360097 > GA functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;GA|frameshift_variant|HIGH|KPNIH1_RS30220|c.32dupT|p.Ile12fs|32/144|11/47|mgrB|PhoP/PhoQ regulator MgrB;_1973\"                                                                                        #>  [7] \"Coding Indel at 3360098 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;A|frameshift_variant|HIGH|KPNIH1_RS30220|c.24_31delACTGATAG|p.Leu8fs|31/144|8/47|mgrB|PhoP/PhoQ regulator MgrB;_1974\"                                                                                  #>  [8] \"3360144_3360148|KPNIH1_RS30220-KPNIH1_RS17035|-.+\"                                                                                                                                                                                                                                                                         #>  [9] \"3360057_3360060|KPNIH1_RS30220|-\"                                                                                                                                                                                                                                                                                          #> [10] \"3359997_3360004|KPNIH1_RS30220|-\"                                                                                                                                                                                                                                                                                          #> [11] \"3360056_3360060|KPNIH1_RS30220|-\"                                                                                                                                                                                                                                                                                          #> [12] \"3360032_3360036|KPNIH1_RS30220|-\"                                                                                                                                                                                                                                                                                          #> [13] \"Coding SNP at 1693296 > C functional=NULL_NULL_NULL locus_tag=KPNIH1_RS08505 Strand Information: KPNIH1_RS08505=-;C|missense_variant|MODERATE|KPNIH1_RS08505|c.245T>G|p.Leu82Arg|245/1098|82/365|pmrB|two-component system sensor histidine kinase PmrB;_32525\"                                                            #> [14] \"Coding SNP at 3058674 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS15525 Strand Information: KPNIH1_RS15525=+;T|missense_variant|MODERATE|KPNIH1_RS15525|c.29A>T|p.Gln10Leu|29/1062|10/353|ccrB|HAMP domain-containing histidine kinase CrrB;_62072\"                                                                   #> [15] \"Coding SNP at 3058925 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS15525 Strand Information: KPNIH1_RS15525=+;A|missense_variant|MODERATE|KPNIH1_RS15525|c.280C>A|p.Leu94Met|280/1062|94/353|ccrB|HAMP domain-containing histidine kinase CrrB;_62078\"                                                                 #> [16] \"Coding SNP at 3059096 > A,T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS15525 Strand Information: KPNIH1_RS15525=+;T|missense_variant|MODERATE|KPNIH1_RS15525|c.451C>T|p.Pro151Ser|451/1062|151/353|ccrB|ccrB;A|missense_variant|MODERATE|KPNIH1_RS15525|c.451C>A|p.Pro151Thr|451/1062|151/353|ccrB|ccrB;_62079\"          #> [17] \"Coding SNP at 3059096 > A,T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS15525 Strand Information: KPNIH1_RS15525=+;T|missense_variant|MODERATE|KPNIH1_RS15525|c.451C>T|p.Pro151Ser|451/1062|151/353|ccrB|ccrB;A|missense_variant|MODERATE|KPNIH1_RS15525|c.451C>A|p.Pro151Thr|451/1062|151/353|ccrB|ccrB;_62080\"          #> [18] \"Coding SNP at 3059193 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS15525 Strand Information: KPNIH1_RS15525=+;T|missense_variant|MODERATE|KPNIH1_RS15525|c.548G>T|p.Gly183Val|548/1062|183/353|ccrB|HAMP domain-containing histidine kinase CrrB;_62085\"                                                               #> [19] \"Coding SNP at 3360039 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;T|missense_variant|MODERATE|KPNIH1_RS30220|c.91G>A|p.Asp31Asn|91/144|31/47|mgrB|PhoP/PhoQ regulator MgrB;_68750\"                                                                                         #> [20] \"Coding SNP at 2080519 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;T|missense_variant|MODERATE|KPNIH1_RS10370|c.731C>A|p.Thr244Asn|731/1467|244/488|phoQ|two-component system sensor histidine kinase PhoQ;_38555\"                                                          #> [21] \"Coding SNP at 1693068 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS08505 Strand Information: KPNIH1_RS08505=-;T|missense_variant|MODERATE|KPNIH1_RS08505|c.473C>A|p.Pro158Gln|473/1098|158/365|pmrB|two-component system sensor histidine kinase PmrB;_32517\"                                                          #> [22] \"Coding SNP at 1694059 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS08510 Strand Information: KPNIH1_RS08510=-;T|missense_variant|MODERATE|KPNIH1_RS08510|c.157G>A|p.Gly53Ser|157/672|53/223|pmrA|two-component system response regulator PmrA;_32532\"                                                                  #> [23] \"Coding SNP at 3360008 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;T|missense_variant|MODERATE|KPNIH1_RS30220|c.122T>A|p.Ile41Asn|122/144|41/47|mgrB|PhoP/PhoQ regulator MgrB;_68749\"                                                                                       #> [24] \"Coding SNP at 3360056 > G functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;G|missense_variant|MODERATE|KPNIH1_RS30220|c.74A>C|p.Asn25Thr|74/144|25/47|mgrB|PhoP/PhoQ regulator MgrB;_68752\"                                                                                         #> [25] \"Non-Coding SNP at 3360138 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220-KPNIH1_RS17035 Strand Information: KPNIH1_RS30220=-/KPNIH1_RS17035=+/;A|intergenic_region|MODIFIER|KPNIH1_RS30220-KPNIH1_RS17035|n.3360138C>A||||mgrB,null or hypothetical protein|PhoP/PhoQ regulator MgrB,hypothetical protein,;_68759\" #> [26] \"Non-Coding SNP at 3360139 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220-KPNIH1_RS17035 Strand Information: KPNIH1_RS30220=-/KPNIH1_RS17035=+/;A|intergenic_region|MODIFIER|KPNIH1_RS30220-KPNIH1_RS17035|n.3360139C>A||||mgrB,null or hypothetical protein|PhoP/PhoQ regulator MgrB,hypothetical protein,;_68760\" #> [27] \"Non-Coding SNP at 3360169 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220-KPNIH1_RS17035 Strand Information: KPNIH1_RS30220=-/KPNIH1_RS17035=+/;T|intergenic_region|MODIFIER|KPNIH1_RS30220-KPNIH1_RS17035|n.3360169A>T||||mgrB,null or hypothetical protein|PhoP/PhoQ regulator MgrB,hypothetical protein,;_68761\" #> [28] \"Non-Coding SNP at 3360177 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220-KPNIH1_RS17035 Strand Information: KPNIH1_RS30220=-/KPNIH1_RS17035=+/;T|intergenic_region|MODIFIER|KPNIH1_RS30220-KPNIH1_RS17035|n.3360177C>T||||mgrB,null or hypothetical protein|PhoP/PhoQ regulator MgrB,hypothetical protein,;_68762\" #> [29] \"Coding SNP at 2081763 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10375 Strand Information: KPNIH1_RS10375=-;A|missense_variant|MODERATE|KPNIH1_RS10375|c.158G>T|p.Gly53Val|158/672|53/223|phoP|two-component system response regulator PhoP;_38580\"                                                                  #> [30] \"Coding SNP at 2080327 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;T|missense_variant|MODERATE|KPNIH1_RS10370|c.923T>A|p.Leu308Gln|923/1467|308/488|phoQ|two-component system sensor histidine kinase PhoQ;_38551\"                                                          #> [31] \"Coding SNP at 2080480 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;T|missense_variant|MODERATE|KPNIH1_RS10370|c.770T>A|p.Leu257Gln|770/1467|257/488|phoQ|two-component system sensor histidine kinase PhoQ;_38553\"                                                          #> [32] \"Coding SNP at 2080508 > G functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;G|missense_variant|MODERATE|KPNIH1_RS10370|c.742A>C|p.Thr248Pro|742/1467|248/488|phoQ|two-component system sensor histidine kinase PhoQ;_38554\"                                                          #> [33] \"Coding SNP at 2080936 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;T|missense_variant|MODERATE|KPNIH1_RS10370|c.314T>A|p.Leu105Gln|314/1467|105/488|phoQ|two-component system sensor histidine kinase PhoQ;_38561\"                                                          #> [34] \"Coding SNP at 2081065 > G functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;G|missense_variant|MODERATE|KPNIH1_RS10370|c.185T>C|p.Leu62Pro|185/1467|62/488|phoQ|two-component system sensor histidine kinase PhoQ;_38564\"                                                            #> [35] \"Coding SNP at 1692756 > G functional=NULL_NULL_NULL locus_tag=KPNIH1_RS08505 Strand Information: KPNIH1_RS08505=-;G|missense_variant|MODERATE|KPNIH1_RS08505|c.785T>C|p.Leu262Pro|785/1098|262/365|pmrB|two-component system sensor histidine kinase PmrB;_32509\"                                                          #> [36] \"Coding SNP at 1692934 > G functional=NULL_NULL_NULL locus_tag=KPNIH1_RS08505 Strand Information: KPNIH1_RS08505=-;G|missense_variant|MODERATE|KPNIH1_RS08505|c.607T>C|p.Ser203Pro|607/1098|203/365|pmrB|two-component system sensor histidine kinase PmrB;_32516\"                                                          #> [37] \"Coding SNP at 3059243 > C functional=NULL_NULL_NULL locus_tag=KPNIH1_RS15525 Strand Information: KPNIH1_RS15525=+;C|missense_variant|MODERATE|KPNIH1_RS15525|c.598G>C|p.Ala200Pro|598/1062|200/353|ccrB|HAMP domain-containing histidine kinase CrrB;_62089\"                                                               #> [38] \"3059600_3059605|KPNIH1_RS15525|+\"                                                                                                                                                                                                                                                                                          #> [39] \"Coding SNP at 3360069 > G functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;G|missense_variant|MODERATE|KPNIH1_RS30220|c.61A>C|p.Thr21Pro|61/144|21/47|mgrB|PhoP/PhoQ regulator MgrB;_68756\"                                                                                         #> [40] \"Coding SNP at 2081316 > G functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10375 Strand Information: KPNIH1_RS10375=-;G|missense_variant|MODERATE|KPNIH1_RS10375|c.605A>C|p.Gln202Pro|605/672|202/223|phoP|two-component system response regulator PhoP;_38572\"                                                                #> [41] \"Coding SNP at 2081356 > G functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10375 Strand Information: KPNIH1_RS10375=-;G|missense_variant|MODERATE|KPNIH1_RS10375|c.565A>C|p.Thr189Pro|565/672|189/223|phoP|two-component system response regulator PhoP;_38573\"                                                                #> [42] \"Coding SNP at 2081357 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10375 Strand Information: KPNIH1_RS10375=-;T|missense_variant|MODERATE|KPNIH1_RS10375|c.564C>A|p.His188Gln|564/672|188/223|phoP|two-component system response regulator PhoP;_38574\"                                                                #> [43] \"Coding SNP at 2081358 > C functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10375 Strand Information: KPNIH1_RS10375=-;C|missense_variant|MODERATE|KPNIH1_RS10375|c.563A>G|p.His188Arg|563/672|188/223|phoP|two-component system response regulator PhoP;_38575\"                                                                #> [44] \"Coding SNP at 2081367 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10375 Strand Information: KPNIH1_RS10375=-;A|missense_variant|MODERATE|KPNIH1_RS10375|c.554G>T|p.Arg185Leu|554/672|185/223|phoP|two-component system response regulator PhoP;_38576\"                                                                #> [45] \"Coding SNP at 2081589 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10375 Strand Information: KPNIH1_RS10375=-;T|missense_variant|MODERATE|KPNIH1_RS10375|c.332G>A|p.Arg111His|332/672|111/223|phoP|two-component system response regulator PhoP;_38578\"                                                                #> [46] \"Coding SNP at 2081868 > G functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10375 Strand Information: KPNIH1_RS10375=-;G|missense_variant|MODERATE|KPNIH1_RS10375|c.53T>C|p.Val18Ala|53/672|18/223|phoP|two-component system response regulator PhoP;_38581\"                                                                    #> [47] \"Coding Indel at 2081355 > G functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10375 Strand Information: KPNIH1_RS10375=-;G|frameshift_variant|HIGH|KPNIH1_RS10375|c.565delA|p.Thr189fs|565/672|189/223|phoP|two-component system response regulator PhoP;_1050\"                                                                 #> [48] \"Coding Indel at 2081358 > TC functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10375 Strand Information: KPNIH1_RS10375=-;TC|frameshift_variant|HIGH|KPNIH1_RS10375|c.562_563insG|p.His188fs|562/672|188/223|phoP|two-component system response regulator PhoP;_1051\"                                                           #> [49] \"Coding SNP at 2079808 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;A|missense_variant|MODERATE|KPNIH1_RS10370|c.1442A>T|p.Gln481Leu|1442/1467|481/488|phoQ|two-component system sensor histidine kinase PhoQ;_38535\"                                                        #> [50] \"Coding SNP at 2079899 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;T|missense_variant|MODERATE|KPNIH1_RS10370|c.1351G>A|p.Ala451Thr|1351/1467|451/488|phoQ|two-component system sensor histidine kinase PhoQ;_38537\"                                                        #> [51] \"Coding SNP at 2079923 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;T|missense_variant|MODERATE|KPNIH1_RS10370|c.1327G>A|p.Gly443Ser|1327/1467|443/488|phoQ|two-component system sensor histidine kinase PhoQ;_38539\"                                                        #> [52] \"Coding SNP at 2079952 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;A|missense_variant|MODERATE|KPNIH1_RS10370|c.1298G>T|p.Arg433Leu|1298/1467|433/488|phoQ|two-component system sensor histidine kinase PhoQ;_38540\"                                                        #> [53] \"Coding SNP at 2080000 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;A|missense_variant|MODERATE|KPNIH1_RS10370|c.1250A>T|p.Asp417Val|1250/1467|417/488|phoQ|two-component system sensor histidine kinase PhoQ;_38541\"                                                        #> [54] \"Coding SNP at 2080286 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;T|missense_variant|MODERATE|KPNIH1_RS10370|c.964C>A|p.Leu322Met|964/1467|322/488|phoQ|two-component system sensor histidine kinase PhoQ;_38550\"                                                          #> [55] \"Coding SNP at 2080883 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;T|missense_variant|MODERATE|KPNIH1_RS10370|c.367G>A|p.Glu123Lys|367/1467|123/488|phoQ|two-component system sensor histidine kinase PhoQ;_38558\"                                                          #> [56] \"Coding SNP at 2081144 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;T|missense_variant|MODERATE|KPNIH1_RS10370|c.106G>A|p.Ala36Thr|106/1467|36/488|phoQ|two-component system sensor histidine kinase PhoQ;_38567\"                                                            #> [57] \"Coding Indel at 2080219 > AG functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;AG|frameshift_variant|HIGH|KPNIH1_RS10370|c.1030dupC|p.Leu344fs|1030/1467|344/488|phoQ|two-component system sensor histidine kinase PhoQ;_1048\"                                                       #> [58] \"Coding Indel at 2080486 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;T|disruptive_inframe_deletion|MODERATE|KPNIH1_RS10370|c.743_763delCCCGGCTGGTCAGCAACCTCA|p.Thr248_Leu254del|763/1467|248/488|phoQ|two-component system sensor histidine kinase PhoQ;_1049\"              #> [59] \"Coding Indel at 3059657 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS15525 Strand Information: KPNIH1_RS15525=+;A|frameshift_variant|HIGH|KPNIH1_RS15525|c.1013_1016delGTTT|p.Ser338fs|1013/1062|338/353|ccrB|HAMP domain-containing histidine kinase CrrB;_1761\"                                                      #> [60] \"Coding SNP at 3359999 > C functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;C|missense_variant|MODERATE|KPNIH1_RS30220|c.131T>G|p.Phe44Cys|131/144|44/47|mgrB|PhoP/PhoQ regulator MgrB;_68747\"                                                                                       #> [61] \"Coding SNP at 3360059 > G functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;G|missense_variant|MODERATE|KPNIH1_RS30220|c.71T>C|p.Leu24Pro|71/144|24/47|mgrB|PhoP/PhoQ regulator MgrB;_68753\"                                                                                         #> [62] \"Coding SNP at 3360074 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;T|missense_variant|MODERATE|KPNIH1_RS30220|c.56T>A|p.Leu19Gln|56/144|19/47|mgrB|PhoP/PhoQ regulator MgrB;_68757\"                                                                                         #> [63] \"Coding SNP at 2081682 > C functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10375 Strand Information: KPNIH1_RS10375=-;C|missense_variant|MODERATE|KPNIH1_RS10375|c.239C>G|p.Ala80Gly|239/672|80/223|phoP|two-component system response regulator PhoP;_38579\"                                                                  #> [64] \"Coding SNP at 2079865 > C functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;C|missense_variant|MODERATE|KPNIH1_RS10370|c.1385T>G|p.Ile462Ser|1385/1467|462/488|phoQ|two-component system sensor histidine kinase PhoQ;_38536\"                                                        #> [65] \"Coding SNP at 2080156 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;T|missense_variant|MODERATE|KPNIH1_RS10370|c.1094T>A|p.Leu365His|1094/1467|365/488|phoQ|two-component system sensor histidine kinase PhoQ;_38543\"                                                        #> [66] \"Coding SNP at 2080222 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;A|missense_variant|MODERATE|KPNIH1_RS10370|c.1028C>T|p.Pro343Leu|1028/1467|343/488|phoQ|two-component system sensor histidine kinase PhoQ;_38545\"                                                        #> [67] \"Coding SNP at 2080256 > G functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;G|missense_variant|MODERATE|KPNIH1_RS10370|c.994A>C|p.Thr332Pro|994/1467|332/488|phoQ|two-component system sensor histidine kinase PhoQ;_38549\"                                                          #> [68] \"Coding SNP at 2081101 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;A|missense_variant|MODERATE|KPNIH1_RS10370|c.149G>T|p.Arg50Leu|149/1467|50/488|phoQ|two-component system sensor histidine kinase PhoQ;_38565\"                                                            #> [69] \"Coding SNP at 2081153 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS10370 Strand Information: KPNIH1_RS10370=-;T|missense_variant|MODERATE|KPNIH1_RS10370|c.97G>A|p.Gly33Ser|97/1467|33/488|phoQ|two-component system sensor histidine kinase PhoQ;_38568\"                                                              #> [70] \"2080368_2080380|KPNIH1_RS10370|-\"                                                                                                                                                                                                                                                                                          #> [71] \"Coding SNP at 1693257 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS08505 Strand Information: KPNIH1_RS08505=-;T|missense_variant|MODERATE|KPNIH1_RS08505|c.284C>A|p.Pro95Gln|284/1098|95/365|pmrB|two-component system sensor histidine kinase PmrB;_32522\"                                                            #> [72] \"1692837_1692844|KPNIH1_RS08505|-\"                                                                                                                                                                                                                                                                                          #> [73] \"Coding SNP at 1152157 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS05725 Strand Information: KPNIH1_RS05725=-;A|missense_variant|MODERATE|KPNIH1_RS05725|c.215G>T|p.Ser72Ile|215/288|72/95|null or hypothetical protein|PTS sugar transporter subunit IIB;_22458\"                                                      #> [74] \"1152365_1152368|KPNIH1_RS05725|-\"                                                                                                                                                                                                                                                                                          #> [75] \"Coding SNP at 4653807 > C functional=NULL_NULL_NULL locus_tag=KPNIH1_RS23500 Strand Information: KPNIH1_RS23500=+;C|missense_variant|MODERATE|KPNIH1_RS23500|c.539T>C|p.Val180Ala|539/1350|180/449|qseC|two-component system sensor histidine kinase QseC;_92679\"                                                          #> [76] \"Coding Indel at 4653290 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS23500 Strand Information: KPNIH1_RS23500=+;A|conservative_inframe_deletion|MODERATE|KPNIH1_RS23500|c.34_39delCGCCTG|p.Arg12_Leu13del|34/1350|12/449|qseC|two-component system sensor histidine kinase QseC;_2579\"  paste0(\"Visualization of the genotypes\") #> [1] \"Visualization of the genotypes\" gheatmap(ggtree(tr),genotype_mat %>% mutate_all(as.factor),width = 0.8,colnames = F) + feature_scale #> Scale for y is already present. #> Adding another scale for y, which will replace the existing scale. #> Scale for fill is already present. #> Adding another scale for fill, which will replace the existing scale."},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_phenotype_genotype_investigations.html","id":"step-1-run-ancestral-state-reconstruction","dir":"Articles","previous_headings":"","what":"Step 1: Run ancestral state reconstruction","title":"Phenotype and genotype association testing using ancestral state reconstruction","text":"workhorse function, asr(), used perform ancestral state reconstruction. wrapper function implements ancestral state reconstruction single rate category using corHMM R package: https://github.com/thej022214/corHMM Using inferred ancestral states tip-based data, edges phylogenetic tree evaluated determine episodes trait continued (.e., susceptible -> susceptible non-susceptible -> non-susceptible), gained (.e., susceptible -> non-susceptible), lost (.e., non-susceptible -> susceptible). edge matrix can leveraged numerous applications, including characterizing frequency trait transitions across phylogeny investigating phenotype-genotype associations. following parameters exist function df: Dataframe tip name variable (e.g., tip_name_variable) trait variable (e.g., colistin_ns) tr: Phylogenetic tree object class phylo model: approach permits use either equal rates (ER) rates differ (ARD) transition matrices. Equal rates: Assumes equal transition rates trait gain (e.g., trait absence -> presence) loss (e.g., trait gain -> absence) rates differ: Assumes different transition rates trait gain loss node_states: Whether perform ‘joint’ ‘marginal’ ancestral state reconstruction experience, recommend using joint ancestral state reconstruction.","code":"asr_obj <- phyloAMR::asr(df = df,tr = tr,tip_name_variable = \"tip_name_var\",trait = \"colistin_ns\",model = \"ER\",node_states = \"joint\") #> You specified 'fixed.nodes=FALSE' but included a phy object with node labels. These node labels have been removed. #> State distribution in data: #> States:  0   1    #> Counts:  277 136  #> Beginning thorough optimization search -- performing 0 random restarts  #> Finished. Inferring ancestral states using joint reconstruction.  paste0(\"Output names: \") #> [1] \"Output names: \" names(asr_obj) #> [1] \"corHMM_output\"           \"corHMM_model_statistics\" #> [3] \"parent_child_df\"         \"node_states\"  paste0(\"corHMM_out: output from ancestral state reconstruction algorithm hosted in the R package corHMM\") #> [1] \"corHMM_out: output from ancestral state reconstruction algorithm hosted in the R package corHMM\" asr_obj$corHMM_out #>  #> Fit #>        lnL      AIC    AICc Rate.cat ntax #>  -177.9706 357.9413 357.951        1  413 #>  #> Legend #> [1] \"colistin_ns\" #> [1] \"0\" \"1\" #>  #> Rates #>         0       1 #> 0      NA 89515.8 #> 1 89515.8      NA #>  #> Arrived at a reliable solution  paste0(\"corHMM_model_summary: A summary of the corHMM model, including the number of parameters, model, number of rate categories, inferred transition rates, log likelihood, AIC, and AICc\") #> [1] \"corHMM_model_summary: A summary of the corHMM model, including the number of parameters, model, number of rate categories, inferred transition rates, log likelihood, AIC, and AICc\" paste0(\"Rate 1 = transitions from level 1 (i.e., susceptible) to level 2 (i.e., non-susceptible)\") #> [1] \"Rate 1 = transitions from level 1 (i.e., susceptible) to level 2 (i.e., non-susceptible)\" paste0(\"Rate 2 = transitions from level 2 (i.e., non-susceptible) to level 1 (i.e., susceptible)\") #> [1] \"Rate 2 = transitions from level 2 (i.e., non-susceptible) to level 1 (i.e., susceptible)\" asr_obj$corHMM_model_summary #> NULL  paste0(\"node_states: Chosen node state that was modeled.\") #> [1] \"node_states: Chosen node state that was modeled.\" asr_obj$node_states #> [1] \"joint\"  paste0(\"parent_child_df: Parent child dataframe, which contains the edge dataset, parent and child values, the child name (for tips), and transition data (i.e., gain, loss, and continuation of the trait on tree or continuation of trait absence on tree)\") #> [1] \"parent_child_df: Parent child dataframe, which contains the edge dataset, parent and child values, the child name (for tips), and transition data (i.e., gain, loss, and continuation of the trait on tree or continuation of trait absence on tree)\" head(asr_obj$parent_child_df) #>   parent child parent_value child_value child_name transition gain loss #> 1    414   415            0           0       <NA>          0    0    0 #> 2    415   416            0           0       <NA>          0    0    0 #> 3    416   417            0           0       <NA>          0    0    0 #> 4    417   418            0           1       <NA>          1    1    0 #> 5    418   419            1           1       <NA>          0    0    0 #> 6    419   420            1           1       <NA>          0    0    0 #>   continuation continuation_present continuation_absent #> 1            1                    0                   1 #> 2            1                    0                   1 #> 3            1                    0                   1 #> 4            0                    0                   0 #> 5            1                    1                   0 #> 6            1                    1                   0"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_phenotype_genotype_investigations.html","id":"step-2--synchronous-genotype-phenotype-analyses","dir":"Articles","previous_headings":"","what":"Step 2. Synchronous genotype-phenotype analyses","title":"Phenotype and genotype association testing using ancestral state reconstruction","text":"sake time, run analysis first two genotypes matrix","code":"#> You specified 'fixed.nodes=FALSE' but included a phy object with node labels. These node labels have been removed. #> State distribution in data: #> States:  0   1    #> Counts:  412 1    #> Beginning thorough optimization search -- performing 0 random restarts  #> Finished. Inferring ancestral states using joint reconstruction.  #> You specified 'fixed.nodes=FALSE' but included a phy object with node labels. These node labels have been removed. #> State distribution in data: #> States:  0   1    #> Counts:  412 1    #> Beginning thorough optimization search -- performing 0 random restarts  #> Finished. Inferring ancestral states using joint reconstruction. # Synchronous impact synchronous_df <- lapply(asr_of_genotypes,synchronous_transitions,asr_obj$parent_child_df) %>% do.call(rbind,.) %>% mutate(genotype = variables)     paste0(\"Synchronous data frame\") #> [1] \"Synchronous data frame\" head(synchronous_df) #>   num_trait_gains synchronous_transitions_num synchronous_gains #> 1              37                           0                   #> 2              37                           0                   #>   synchronous_gains_num synchronous_gains_prop synchronous_gain_loss #> 1                     0                      0                       #> 2                     0                      0                       #>   synchronous_gain_loss_num synchronous_gain_loss_prop num_trait_losses #> 1                         0                          0               11 #> 2                         0                          0               11 #>   synchronous_losses synchronous_losses_num synchronous_losses_prop #> 1                                         0                       0 #> 2                                         0                       0 #>   synchronous_loss_gain synchronous_loss_gain_num synchronous_loss_gain_prop #> 1                                               0                          0 #> 2                                               0                          0 #>                                                                                                                                                                                                                   genotype #> 1 Coding SNP at 3359989 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;T|stop_gained|HIGH|KPNIH1_RS30220|c.141G>A|p.Trp47*|141/144|47/47|mgrB|PhoP/PhoQ regulator MgrB;_68746 #> 2 Coding SNP at 3360003 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;A|stop_gained|HIGH|KPNIH1_RS30220|c.127A>T|p.Lys43*|127/144|43/47|mgrB|PhoP/PhoQ regulator MgrB;_68748  paste0(\"Number of synchronous gain events per genotype\") #> [1] \"Number of synchronous gain events per genotype\" table(synchronous_df$synchronous_gains_num) #>  #> 0  #> 2  paste0(\"Number of synchronous phenotype gain and genotype loss events per genotype\") #> [1] \"Number of synchronous phenotype gain and genotype loss events per genotype\" table(synchronous_df$synchronous_gain_loss_num) #>  #> 0  #> 2  paste0(\"Number of synchronous phenotype and genotype loss events per genotype\") #> [1] \"Number of synchronous phenotype and genotype loss events per genotype\" table(synchronous_df$synchronous_losses_num) #>  #> 0  #> 2  paste0(\"Number of synchronous phenotype los and genotype gain events per genotype\") #> [1] \"Number of synchronous phenotype los and genotype gain events per genotype\" table(synchronous_df$synchronous_loss_gain_num) #>  #> 0  #> 2"},{"path":"https://kylegontjes.github.io/phyloAMR/articles/ancestral_state_reconstruction_phenotype_genotype_investigations.html","id":"step-3-downstream-gainloss-events","dir":"Articles","previous_headings":"","what":"Step 3: Downstream gain/loss events","title":"Phenotype and genotype association testing using ancestral state reconstruction","text":"","code":"downstream_df <- lapply(asr_of_genotypes,downstream_transitions,asr_obj$parent_child_df,tr=tr,node_states='joint') %>% do.call(rbind,.) %>% mutate(genotype = variables)  paste0(\"Downstream data frame\") #> [1] \"Downstream data frame\" head(downstream_df) #>   num_stretches stretches_w_transitions stretches_w_transitions_num #> 1             7                    <NA>                           0 #> 2             7                     647                           1 #>   stretches_w_gains stretches_w_gains_num stretches_w_gains_prop #> 1              <NA>                     0                   0.00 #> 2               647                     1                   0.14 #>   stretches_w_losses stretches_w_losses_num stretches_w_losses_prop #> 1               <NA>                      0                       0 #> 2               <NA>                      0                       0 #>   num_downstream_edges transitions transitions_num transitions_prop gains #> 1                  209        <NA>               0      0.000000000       #> 2                  209         228               1      0.004784689   228 #>   gains_num  gains_prop loss loss_num loss_prop #> 1         0 0.000000000             0         0 #> 2         1 0.004784689             0         0 #>                                                                                                                                                                                                                   genotype #> 1 Coding SNP at 3359989 > T functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;T|stop_gained|HIGH|KPNIH1_RS30220|c.141G>A|p.Trp47*|141/144|47/47|mgrB|PhoP/PhoQ regulator MgrB;_68746 #> 2 Coding SNP at 3360003 > A functional=NULL_NULL_NULL locus_tag=KPNIH1_RS30220 Strand Information: KPNIH1_RS30220=-;A|stop_gained|HIGH|KPNIH1_RS30220|c.127A>T|p.Lys43*|127/144|43/47|mgrB|PhoP/PhoQ regulator MgrB;_68748  paste0(\"Number of downstream gain events per genotype\") #> [1] \"Number of downstream gain events per genotype\" table(downstream_df$stretches_w_gains_num)  #>  #> 0 1  #> 1 1  paste0(\"Number of downstream loss events per genotype\") #> [1] \"Number of downstream loss events per genotype\" table(downstream_df$stretches_w_losses_num)  #>  #> 0  #> 2  paste0(\"Number of downstream loss events per genotype\") #> [1] \"Number of downstream loss events per genotype\" table(downstream_df$stretches_w_losses_num)  #>  #> 0  #> 2"},{"path":"https://kylegontjes.github.io/phyloAMR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Kyle Gontjes. Maintainer, author.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Gontjes K (2025). phyloAMR: Phylogenetic Analysis Genome-Influenced Traits. R package version 0.1.0, https://github.com/kylegontjes/phyloAMR.","code":"@Manual{,   title = {phyloAMR: Phylogenetic Analysis of Genome-Influenced Traits},   author = {Kyle Gontjes},   year = {2025},   note = {R package version 0.1.0},   url = {https://github.com/kylegontjes/phyloAMR}, }"},{"path":"https://kylegontjes.github.io/phyloAMR/index.html","id":"phyloamr-an-r-package-to-perform-phylogenetic-analysis-of-antimicrobial-resistance","dir":"","previous_headings":"","what":"Phylogenetic Analysis of Genome-Influenced Traits","title":"Phylogenetic Analysis of Genome-Influenced Traits","text":"Description phyloAMR R package characterizes evolutionary history genome-influenced traits investigate phenotype-genotype associations. built evaluate phylogenetics antimicrobial resistance, can applied genome-influenced traits, including infection severity source infection. Leveraging corHMM’s ancestral state reconstruction, package characterizes trait’s gain, loss, continuation across phylogeny. inferred ancestral states can adress numerous questions, : 1. often antibiotic-resistant bacterium emerge spread across healthcare network? 2. genotypes associated gain loss antibiotic resistance? 3. compensatory revertant mutations follow genome-informed trait? Additional phylogenetically-informed algorithms, use ancestral state reconstruction, developed: 1. nearest_neighbor_algorithm(): Identification isolate’s nearest neighbor phylogenetic tree. Can used identify isolate’s nearest neighbor without feature (.e., susceptible neighbor resistant isolate). install phyloAMR Questions tool can address","code":"# Install devtools install.packages(\"devtools\", dep = TRUE)  # Install corHMM & phyloAMR from GitHub ## corHMM - installed because the GitHub version is preferred devtools::install_github(\"thej022214/corHMM\", force = TRUE, build_vignettes = FALSE)  ## phyloAMR devtools::install_github(\"kylegontjes/phyloAMR\", force = TRUE, build_vignettes = TRUE)"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr.html","id":null,"dir":"Reference","previous_headings":"","what":"Ancestral state reconstruction wrapper function — asr","title":"Ancestral state reconstruction wrapper function — asr","text":"Function perform ancestral state reconstruction using corHMM. Output parsed dataset episodes trait gain, loss, continuation across phylogeny","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ancestral state reconstruction wrapper function — asr","text":"","code":"asr(   df,   tr,   tip_name_variable,   trait,   model = \"ER\",   node_states = \"joint\",   upper_bound = 1e+50,   lower_bound = 1e-09,   confidence_threshold = NULL )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ancestral state reconstruction wrapper function — asr","text":"df Dataframe tip name (e.g., tip_name_variable) phenotype/trait (e.g., trait) variables tr Phylogeny object class \"phylo\" tip_name_variable Name variable containing tip names dataframe (df). Tip name variable must correspond tip names tree. trait Name phenotype/trait variable dataframe (df). model Type rate transition matrix. Options: equal rates model (\"ER\") rates different (\"ARD\"). option, \"MF\", selects best performing model using sample-size corrected Akaike information criterium (AICc). Default: ER node_states Perform \"joint\" \"marginal\" reconstruction. Default: joint upper_bound Upper bound likelihood search. Default: 1e50 lower_bound Lower bound likelihood search. Default: 1e-9 confidence_threshold confidence threshold categorize ancestral state inferences marginal reconstruction.suggest using value 0.5 (.e., winner takes ), permit modification elevated values. Required node_states == \"marginal\".","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ancestral state reconstruction wrapper function — asr","text":"corHMM_output corHMM output corHMM_model_statistics Dataframe containing inferred rates, log-likelihood, AIC, chosen transition model. See documentation characterize_asr_model information. parent_child_df Dataframe parent-child relationships additional descriptive information node_states Characetr string whether \"joint\" \"marginal\" reconstruction performed","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr_cluster_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Analysis of trait clustering on a phylogeny — asr_cluster_analysis","title":"Analysis of trait clustering on a phylogeny — asr_cluster_analysis","text":"function calculates clustering statistics (e.g., number singletons, clusters, features). Alongside frequency events, size resistance revertant clusters reported. Two additional statistsics employed: 1. Phylogenetic frequency: . clusters + singletons / total opportunities (.e., phylogenetic events + tips without trait) 2. Clustering frequency:  . clusters / total phylogenetic events (.e., singleton events + clusters)","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr_cluster_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Analysis of trait clustering on a phylogeny — asr_cluster_analysis","text":"","code":"asr_cluster_analysis(tip_data_df)"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr_cluster_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Analysis of trait clustering on a phylogeny — asr_cluster_analysis","text":"tip_data_df Tip data frame object asr_cluster_detection()","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr_cluster_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Analysis of trait clustering on a phylogeny — asr_cluster_analysis","text":"Dataframe row data phylogenetic clustering trait.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr_cluster_detection.html","id":null,"dir":"Reference","previous_headings":"","what":"Identification of trait emergence and clustering of trait across the phylogeny using transition data — asr_cluster_detection","title":"Identification of trait emergence and clustering of trait across the phylogeny using transition data — asr_cluster_detection","text":"function identifies episodes trait emergence loss across phylogenetic tree.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr_cluster_detection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identification of trait emergence and clustering of trait across the phylogeny using transition data — asr_cluster_detection","text":"","code":"asr_cluster_detection(   df,   tr,   tip_name_variable,   patient_id = NULL,   parent_child_df,   node_states = \"joint\",   confidence = NULL,   simplify_faux_clusters = FALSE,   simplify_revertant = TRUE,   collapse_cluster = TRUE )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr_cluster_detection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identification of trait emergence and clustering of trait across the phylogeny using transition data — asr_cluster_detection","text":"df Dataframe tip name variable phenotype tr Phylogenetic tree tip_name_variable Name variable containing tip names df patient_id Name variable containing patient IDs, can combined faux_clusters option factor whether cluster >1 patient. (Optional) parent_child_df Parent child dataframe asr() object node_states Whether reconstruction \"joint\" \"marginal\" confidence Whether use 'high' (.e., 0 -> 1) 'low' (.e., transition) confidence transitions determining clustering marginal ancestral state reconstruction results. confidence_threshold value asr() > 0.5, set confidence 'low'. Otherwise, set confidence 'high'. simplify_faux_clusters Boolean (.e., TRUE/FALSE), whether collapse faux clusters (.e., clusters 1 patient contributes isolates) singletons without distinction (Optional) simplify_revertant Boolean (.e., TRUE/FALSE). Whether collapse revertant episodes isolates without trait cleaned text string collapse_cluster Boolean (.e., TRUE/FALSE). Whether create variable collapses cluster calls one category","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr_cluster_detection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identification of trait emergence and clustering of trait across the phylogeny using transition data — asr_cluster_detection","text":"tip-dataframe inferences ancestral history strains. Can merged parent_child_df asr() desired asr_cluster Character string indicating cluster calls (cluster_[node]), singleton calls, traits without feature (feature), revertant cases tip (revertant_tip) clusters revertants (revertant_cluster_[node]). patient_id != NULL, additional calls may provided cluster contains one patient (cluster_[node]_1pt_only) patient_id Character string patient ID, provided asr_cluster_renamed Character string asr_cluster string renamed cluster [. X], singletons, feature. Clusters ordered presentation via ggtree. simplify_revertant == TRUE, revertants collapsed 'feature' asr_cluster_collapsed Character string asr_cluster string collapsed cluster, singleton, feature, revertant. simplify_revertant == TRUE, revertants collapsed 'feature'","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr_transition_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumeration of trait transitions using ancestral state reconstruction — asr_transition_analysis","title":"Enumeration of trait transitions using ancestral state reconstruction — asr_transition_analysis","text":"Calculate transition statistics (e.g., gain, loss, continuation) ancestral state reconstruction model. Values include number transitions, gain events, loss events, continuation events, number gains losses tip. Additional frequency statistics include frequency gain events (gains / parents without trait), loss events (losses / parents trait), proportion edges continuation events.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr_transition_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumeration of trait transitions using ancestral state reconstruction — asr_transition_analysis","text":"","code":"asr_transition_analysis(parent_child_df, node_states = \"joint\")"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr_transition_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Enumeration of trait transitions using ancestral state reconstruction — asr_transition_analysis","text":"parent_child_df parent_child_df object returned sfrom asr() function node_states 'joint' 'marginal' reconstruction used","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/asr_transition_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Enumeration of trait transitions using ancestral state reconstruction — asr_transition_analysis","text":"Dataframe transition statistics trait.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/characterize_asr_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Characterize ancestral state reconstruction model — characterize_asr_model","title":"Characterize ancestral state reconstruction model — characterize_asr_model","text":"Function report model statistics binary ancestral state reconstruction model","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/characterize_asr_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Characterize ancestral state reconstruction model — characterize_asr_model","text":"","code":"characterize_asr_model(corHMM_obj)"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/characterize_asr_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Characterize ancestral state reconstruction model — characterize_asr_model","text":"corHMM_obj Ancestral reconstruction model corHMM::corHMM","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/characterize_asr_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Characterize ancestral state reconstruction model — characterize_asr_model","text":"Dataframe containing model fit (.e., log-likelihood AIC), rates, model type (.e., ER ARD)#' model Model number_parameters Number parameters model number_rate_categories Number rate categories rate1 Rate 1 rate2 Rate 2 loglik Log-likelihood model AIC Akaike information criteria AICc Sample size corected Akaike information criteria","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/df.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataframe with relevant data — df","title":"Dataframe with relevant data — df","text":"413 carbapenem-resistant Klebsiella pneumoniae isolates long-term acute care hospitals across United States America. Whole-genome sequencing antimicrobial susceptibility testing performed isolate","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataframe with relevant data — df","text":"","code":"df"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/df.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dataframe with relevant data — df","text":"## `df` Dataframe 413 rows 4 columns","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/df.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Dataframe with relevant data — df","text":"<https://github.com/Snitkin-Lab-Umich/ltach-crkp-colistin-ms>","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/downstream_permutation_test.html","id":null,"dir":"Reference","previous_headings":"","what":"downstream_permutation_test: Permutation test for downstream analysis — downstream_permutation_test","title":"downstream_permutation_test: Permutation test for downstream analysis — downstream_permutation_test","text":"Permutation test analysis downstream gain loss comparitor trait stretches different trait interest","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/downstream_permutation_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"downstream_permutation_test: Permutation test for downstream analysis — downstream_permutation_test","text":"","code":"downstream_permutation_test(   comparitor,   df,   tr,   tip_name_variable,   trait,   node_states = \"joint\",   confidence_threshold = NULL,   confidence = NULL,   num_permutations = 1000,   num_cores = 6 )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/downstream_permutation_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"downstream_permutation_test: Permutation test for downstream analysis — downstream_permutation_test","text":"comparitor Comparitor trait, genotype different trait/phenotype df Dataframe trait comparitor tip_name_variable tr Phylogenetic tree tip_name_variable Tip name variable trait Trait interest. stretches trait presence characterized evaluated node_states Joint marginal reconstruction confidence_threshold Set value confidence threshold MLE calls marginal confidence Whether use high low confidence transition nodes node_states marginal num_permutations Number permutations. Default = 1000 num_cores Number cores. Default = 6","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/downstream_permutation_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"downstream_permutation_test: Permutation test for downstream analysis — downstream_permutation_test","text":"Summary stats downstream gain loss trait","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/downstream_transitions.html","id":null,"dir":"Reference","previous_headings":"","what":"Analysis of downstream transitions of comparitor traits — downstream_transitions","title":"Analysis of downstream transitions of comparitor traits — downstream_transitions","text":"Downstream gain loss comparitor trait stretches different trait interest","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/downstream_transitions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Analysis of downstream transitions of comparitor traits — downstream_transitions","text":"","code":"downstream_transitions(   comparitor_parent_child_df,   trait_parent_child_df,   tr,   node_states = \"joint\",   confidence = NULL )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/downstream_transitions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Analysis of downstream transitions of comparitor traits — downstream_transitions","text":"comparitor_parent_child_df Parent child dataset comparitor trait, genotype different trait/phenotype trait_parent_child_df Parent child dataset trait interest, trait/phenotype tr Phylogenetic tree node_states Joint marginal reconstruction confidence Whether use high low confidence transition nodes node_states marginal","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/downstream_transitions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Analysis of downstream transitions of comparitor traits — downstream_transitions","text":"Summary stats downstream gain loss trait","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/find_best_asr_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Determine best model for ancestral state reconstruction — find_best_asr_model","title":"Determine best model for ancestral state reconstruction — find_best_asr_model","text":"Function find best model ancestral state reconstruction using corHMM.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/find_best_asr_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determine best model for ancestral state reconstruction — find_best_asr_model","text":"","code":"find_best_asr_model(   df,   tr,   tip_name_variable,   trait,   node_states = \"joint\",   upper_bound = 1e+50,   lower_bound = 1e-09 )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/find_best_asr_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Determine best model for ancestral state reconstruction — find_best_asr_model","text":"df Dataframe tip name (e.g., tip_name_variable) phenotype/trait (e.g., trait) variables tr Phylogeny object class \"phylo\" tip_name_variable Name variable containing tip names dataframe (df). Tip name variable must correspond tip names tree. trait Name phenotype/trait variable dataframe (df). node_states Perform \"joint\" \"marginal\" reconstruction. Default: joint upper_bound Upper bound likelihood search. Default: 1e50 lower_bound Lower bound likelihood search. Default: 1e-9","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/find_best_asr_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Determine best model for ancestral state reconstruction — find_best_asr_model","text":"model_statistics Dataframe summary model options best_model Character string indicating best model (.e., \"ER\" \"ARD) node_states Characetr string whether \"joint\" \"marginal\" reconstruction performed corHMM_output_best_model corHMM output best model","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/genotype_mat.html","id":null,"dir":"Reference","previous_headings":"","what":"Genotype matrix — genotype_mat","title":"Genotype matrix — genotype_mat","text":"Row names correspond isolate names, found tr$tip.name df$tip_name_var. Columns correspond colistin-related genotypes identified aforementioned study. genotypes can leveraged test synchronous downstream phenotype-genotype transition events synchronous_detection() downstream_gain_loss() functions, respectively","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/genotype_mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Genotype matrix — genotype_mat","text":"","code":"genotype_mat"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/genotype_mat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Genotype matrix — genotype_mat","text":"## `genotype_mat` Dataframe 413 rows 76 columns","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/genotype_mat.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Genotype matrix — genotype_mat","text":"<https://github.com/Snitkin-Lab-Umich/ltach-crkp-colistin-ms>","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/get_continuation_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate parent child data from ancestral state reconstruction with transition data — get_continuation_data","title":"Annotate parent child data from ancestral state reconstruction with transition data — get_continuation_data","text":"Function generate annotated edge matrix transition data","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/get_continuation_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate parent child data from ancestral state reconstruction with transition data — get_continuation_data","text":"","code":"get_continuation_data(parent_child_df, node_states)"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/get_continuation_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate parent child data from ancestral state reconstruction with transition data — get_continuation_data","text":"parent_child_df Dataframe ancestral tip states node_states Whether perform \"joint\" \"marginal\" reconstruction. Default: joint","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/get_continuation_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate parent child data from ancestral state reconstruction with transition data — get_continuation_data","text":"Annotated parent child dataframe transition data. coding, 1 == yes 0 == . marginal states requested, 0.5 = unsure. transition Whether parent child nodes value gain Whether gain event occured (.e., child value, parent ) loss Whether loss event occured (.e., parent value, child ) continuation Whether continuation event occurrent (.e., parent child value) continuation_present Continuation event parent child trait continuation_absent Continuation event parent child trait node_states == 'marginal', following additional values returned transition_high Transition event states confident (.e., 0 -> 1) per MLE confidence threshold transition_low Transition event one state confident unsure (.e., 0 -> 0.5)) gain_high Gain event states confident (.e., 0 -> 1) gain_low Gain event parental value unsure ).e., 0.5 -> 1 loss_high Loss event sattes confident (.e., 1 -> 0) loss_low Loss event parental value unsure (.e., 0.5 -> 0) continuation_high Continuation event parent child confident state inferences (.e., 1 -> 1) continuation_low Continuation event parent child unsure state inferences (e.g., 0.5 -> 0.5)","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/get_parent_child_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Get parent child data from ancestral state reconstruction — get_parent_child_data","title":"Get parent child data from ancestral state reconstruction — get_parent_child_data","text":"Function generate annotated edge matrix ancestral tip states","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/get_parent_child_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get parent child data from ancestral state reconstruction — get_parent_child_data","text":"","code":"get_parent_child_data(   tr,   ancestral_states,   trait_data,   node_states,   confidence_threshold = NULL )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/get_parent_child_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get parent child data from ancestral state reconstruction — get_parent_child_data","text":"tr Phylogeny object class \"phylo\" ancestral_states Ancestral states inferred corHMM. Stored corHMM_obj$states trait_data Named phenotype/trait string. Strings' values correspond tip states. Strings' names correspond tip names. node_states Perform \"joint\" \"marginal\" reconstruction. Default: joint confidence_threshold confidence threshold categorize ancestral state inferences marginal reconstruction.suggest using value 0.5 (.e., winner takes ), permit modification elevated values. Required node_states == \"marginal\". MLE estimate fit threshold, node's prediction 'unsure' labeled 0.5.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/get_parent_child_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get parent child data from ancestral state reconstruction — get_parent_child_data","text":"Dataframe ancestral tip states parent upstream node child child downstream node parent parent_value Trait value parental node child_value Trait value child node child_name Character string specifying name child, tip.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/nearest_neighbor_algorithm.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify the phylogenetic nearest neighbor of a tip — nearest_neighbor_algorithm","title":"Identify the phylogenetic nearest neighbor of a tip — nearest_neighbor_algorithm","text":"function uses phylogenetics identify isolate's nearest neighbor.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/nearest_neighbor_algorithm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify the phylogenetic nearest neighbor of a tip — nearest_neighbor_algorithm","text":"","code":"nearest_neighbor_algorithm(   isolate,   phylogenetic_distance,   variant_distance,   metadata,   annotate = NULL,   variables_of_interest = NULL,   comparison = NULL,   comparison_feature = NULL )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/nearest_neighbor_algorithm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify the phylogenetic nearest neighbor of a tip — nearest_neighbor_algorithm","text":"isolate Isolate interest phylogenetic_distance Matrix phylogenetic distance variant_distance Provide secondary distance measure metadata Dataframe trait variables interest annotate Boolean (TRUE/FALSE) indicating annotation necessary variables_of_interest Variables found metadata comparison Boolean (TRUE/FALSE) indicating whether focus isolates /without trait comparison_feature Name variable compare.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/nearest_neighbor_algorithm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify the phylogenetic nearest neighbor of a tip — nearest_neighbor_algorithm","text":"nearest neighbor interest.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/nearest_neighbor_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"nearest_neighbor_analysis: Generate nearest neighbor comparisons for isolate pairs — nearest_neighbor_analysis","title":"nearest_neighbor_analysis: Generate nearest neighbor comparisons for isolate pairs — nearest_neighbor_analysis","text":"function compare isolate nearest neighbor. functionality categorical continuous variables.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/nearest_neighbor_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"nearest_neighbor_analysis: Generate nearest neighbor comparisons for isolate pairs — nearest_neighbor_analysis","text":"","code":"nearest_neighbor_analysis(   comparison_df,   categorical_vars = NULL,   binary_vars = NULL,   continuous_vars = NULL,   log_2 = FALSE )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/nearest_neighbor_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"nearest_neighbor_analysis: Generate nearest neighbor comparisons for isolate pairs — nearest_neighbor_analysis","text":"comparison_df Dataframe isolates nearest neighbors. categorical_vars Categorical variables. Must comparison_df binary_vars Binary variables. Must comparison_df coded 0 1. continuous_vars Continuous variables. Must comparison_df log_2 Boolean (TRUE/FALSE) Whether perform log-2 transformation continuous variables","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/nearest_neighbor_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"nearest_neighbor_analysis: Generate nearest neighbor comparisons for isolate pairs — nearest_neighbor_analysis","text":"Dataframe differences categorical continuous variables isolate nearest neighbor","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/nearest_neighbor_analysis.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"nearest_neighbor_analysis: Generate nearest neighbor comparisons for isolate pairs — nearest_neighbor_analysis","text":"function use phylogenetic tree identify isolate's nearest neighbor.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/nearest_neighbor_summary_statistics.html","id":null,"dir":"Reference","previous_headings":"","what":"nearest_neighbor_summary_statistics: Generate summary statistics of nearest neighbor comparisons for isolate pairs — nearest_neighbor_summary_statistics","title":"nearest_neighbor_summary_statistics: Generate summary statistics of nearest neighbor comparisons for isolate pairs — nearest_neighbor_summary_statistics","text":"function generate summary statistics nearest neighbor comparisons","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/nearest_neighbor_summary_statistics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"nearest_neighbor_summary_statistics: Generate summary statistics of nearest neighbor comparisons for isolate pairs — nearest_neighbor_summary_statistics","text":"","code":"nearest_neighbor_summary_statistics(   nn_diff_df,   categorical_vars = NULL,   binary_vars = NULL,   continuous_vars = NULL,   log_2 = FALSE )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/nearest_neighbor_summary_statistics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"nearest_neighbor_summary_statistics: Generate summary statistics of nearest neighbor comparisons for isolate pairs — nearest_neighbor_summary_statistics","text":"nn_diff_df Dataframe isolates nearest neighbors, generated nearest_neighbor_analysis. categorical_vars Categorical variables. Must comparison_df binary_vars Binary variables. Must comparison_df coded 0 1. continuous_vars Continuous variables. Must comparison_df log_2 Boolean (TRUE/FALSE) Whether perform log-2 transformation continuous variables","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/nearest_neighbor_summary_statistics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"nearest_neighbor_summary_statistics: Generate summary statistics of nearest neighbor comparisons for isolate pairs — nearest_neighbor_summary_statistics","text":"Dataframe differences categorical continuous variables isolate nearest neighbor","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/paint_tree_with_states.html","id":null,"dir":"Reference","previous_headings":"","what":"Paint a phylogenetic tree with ancestral and tip states — paint_tree_with_states","title":"Paint a phylogenetic tree with ancestral and tip states — paint_tree_with_states","text":"Function paint tree ancestral tip statess","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/paint_tree_with_states.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Paint a phylogenetic tree with ancestral and tip states — paint_tree_with_states","text":"","code":"paint_tree_with_states(   parent_child_df,   tr,   scale_breaks = c(1, 0),   scale_labels = c(\"Present\", \"Absent\"),   scale_colors = c(\"red\", \"black\"),   legend_name = \"Trait\" )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/paint_tree_with_states.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Paint a phylogenetic tree with ancestral and tip states — paint_tree_with_states","text":"parent_child_df Parent child dataframe asr() tr Phylogenetic tree scale_breaks Values breaks (marginal = c(1,0.5,0); joint = c(1,0)) scale_labels Labels present absent, marginal c('Present','Unsure','Absent') scale_colors Colors states legend_name Name legend","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/paint_tree_with_states.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Paint a phylogenetic tree with ancestral and tip states — paint_tree_with_states","text":"Tree object painted states","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/phyloaware_dataset_curation.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataset curation for phylogenetically aware regression — phyloaware_dataset_curation","title":"Dataset curation for phylogenetically aware regression — phyloaware_dataset_curation","text":"Curate three datasetes phylogenetically aware regression.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/phyloaware_dataset_curation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataset curation for phylogenetically aware regression — phyloaware_dataset_curation","text":"","code":"phyloaware_dataset_curation(   trait,   df,   first_present = NULL,   patient_id = NULL,   culture_date = NULL )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/phyloaware_dataset_curation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Dataset curation for phylogenetically aware regression — phyloaware_dataset_curation","text":"trait Outcome interest. Character string. df Dataset trait variable asr_cluster. Must contain patient_id culture_date variables first_present == TRUE. first_present Boolean (.e., TRUE/FALSE) indicating whether take first present isolate patient_id Variable contains IDs group tips (.e., Patient ID). Character string. culture_date Variable contains collection/culture date. Character string.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/phyloaware_dataset_curation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Dataset curation for phylogenetically aware regression — phyloaware_dataset_curation","text":"Three datasets labeled 'present', 'singleton', 'cluster'.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/phyloaware_regression.html","id":null,"dir":"Reference","previous_headings":"","what":"phyloaware_regression: Phylogenetically-aware regression — phyloaware_regression","title":"phyloaware_regression: Phylogenetically-aware regression — phyloaware_regression","text":"function performs regression dataset","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/phyloaware_regression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"phyloaware_regression: Phylogenetically-aware regression — phyloaware_regression","text":"","code":"phyloaware_regression(   trait,   variables,   df,   first_present = NULL,   patient_id = NULL,   culture_date = NULL,   multivariable = NULL,   stepwise_direction = NULL,   entry_criteria = NULL,   retention_criteria = NULL,   confounding_criteria = NULL )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/phyloaware_regression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"phyloaware_regression: Phylogenetically-aware regression — phyloaware_regression","text":"trait Trait interest variables Exposure variables interest df Dataframe first_present Boolean (.e., TRUE, FALSE) whether select participant's first isolate trait. patient_id Patient identifier variable stored dataframe df. Required first_present == TRUE. culture_date Culture date used select participant's first isolate. Must stored variable dataframe df. Required first_present == TRUE. multivariable Defines multivariable selection strategy. Options include: 'purposeful', 'AIC', 'pvalue', 'multivariable.' stepwise_direction Direction stepwise selection. Options include: '', 'backward', 'forward'. entry_criteria P-value defining candidate variables multivariable regression. Used pvalue purposeful selection) retention_criteria P-value retaining candidate variables model (used pvalue purposeful selection) confounding_criteria Impact effect size purposeful selection (used purposeful selection)","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/phyloaware_regression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"phyloaware_regression: Phylogenetically-aware regression — phyloaware_regression","text":"List univariable multivariable results (requested)","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling `rhs(lhs)`.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/purposeful_selection_algorithm.html","id":null,"dir":"Reference","previous_headings":"","what":"Logistic regression using purposeful selection — purposeful_selection_algorithm","title":"Logistic regression using purposeful selection — purposeful_selection_algorithm","text":"Uses purposeful selection algorithm identify regression model. Three steps exist: 1. Unadjusted logistic regression identify candidate variables p-value threshold (entry_criteria) 2. Multivariable regression candidate variables. Iterative process, starting value highest p-value, variables retained fall category significant variable (< retention_criteria) confounding (.e., effect size +/- confounding criteria). 3. variables failed step 1 introduced model retained p-value < retention criteria (retention_criteria) Reference: https://scfbm.biomedcentral.com/articles/10.1186/1751-0473-3-17","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/purposeful_selection_algorithm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logistic regression using purposeful selection — purposeful_selection_algorithm","text":"","code":"purposeful_selection_algorithm(   outcome,   variables,   dataset,   entry_criteria = 0.2,   retention_criteria = 0.1,   confounding_criteria = 0.2 )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/purposeful_selection_algorithm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logistic regression using purposeful selection — purposeful_selection_algorithm","text":"outcome Outcome interest variables Variables evaluate. Must binarize variables (.e., 0, 1). dataset Dataset outcome variables entry_criteria P-value criteria entry model. Default = 0.2 retention_criteria P-value criteria retention model. Default = 0.1 confounding_criteria Percent change effect size. Set value high (.e., 1000) testing confounding desired. Default = 0.2.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/purposeful_selection_algorithm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logistic regression using purposeful selection — purposeful_selection_algorithm","text":"Regression results step.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/synchronous_permutation_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Synchronous permutation test — synchronous_permutation_test","title":"Synchronous permutation test — synchronous_permutation_test","text":"Permutation test synchronous detection function","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/synchronous_permutation_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Synchronous permutation test — synchronous_permutation_test","text":"","code":"synchronous_permutation_test(   comparitor,   df,   tr,   tip_name_variable,   trait,   node_states = \"joint\",   confidence_threshold = NULL,   confidence = NULL,   num_permutations = 1000,   num_cores = 1 )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/synchronous_permutation_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Synchronous permutation test — synchronous_permutation_test","text":"comparitor Comparitor, genotype different trait/phenotype df Dataframe comparitor, trait, tip_name_variable tr Phylogenetic tree tip_name_variable Tip name variable trait Trait interest, trait/phenotype node_states Joint marginal reconstruction confidence_threshold Confidence threshold using marginal reconstruction confidence Whether use high low confidence transition nodes node_states marginal num_permutations Number permutations. Default: 1000 num_cores Number cores. Default: 1","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/synchronous_permutation_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Synchronous permutation test — synchronous_permutation_test","text":"Synchronous gain loss events two traits p-value permutation testing results","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/synchronous_transitions.html","id":null,"dir":"Reference","previous_headings":"","what":"Analysis of synchronous transitions of two traits — synchronous_transitions","title":"Analysis of synchronous transitions of two traits — synchronous_transitions","text":"Synchronous gain loss two traits spot tree","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/synchronous_transitions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Analysis of synchronous transitions of two traits — synchronous_transitions","text":"","code":"synchronous_transitions(   comparitor_parent_child_df,   trait_parent_child_df,   node_states = \"joint\",   confidence = NULL )"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/synchronous_transitions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Analysis of synchronous transitions of two traits — synchronous_transitions","text":"comparitor_parent_child_df Parent child dataset comparitor trait, genotype different trait/phenotype trait_parent_child_df Parent child dataset trait interest, trait/phenotype node_states Joint marginal reconstruction confidence Whether use high low confidence transition nodes node_states marginal","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/synchronous_transitions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Analysis of synchronous transitions of two traits — synchronous_transitions","text":"Synchronous gain loss events two traits","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/tr.html","id":null,"dir":"Reference","previous_headings":"","what":"Phylogenetic tree — tr","title":"Phylogenetic tree — tr","text":"Newick phylogenetic tree carbapenem-resistant Klebsiella pneumoniae belonging epidemic lineage sequence type 258, constructed using IQ-Tree GTR+G substitution model, 413 tips.","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/tr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phylogenetic tree — tr","text":"","code":"tr"},{"path":"https://kylegontjes.github.io/phyloAMR/reference/tr.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Phylogenetic tree — tr","text":"## `tr` tree 413 trips:","code":""},{"path":"https://kylegontjes.github.io/phyloAMR/reference/tr.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Phylogenetic tree — tr","text":"<https://github.com/Snitkin-Lab-Umich/ltach-crkp-colistin-ms>","code":""},{"path":[]},{"path":"https://kylegontjes.github.io/phyloAMR/news/index.html","id":"changes-0-0-1","dir":"Changelog","previous_headings":"","what":"Changes","title":"phyloAMR 0.0.1","text":"Updated asr_cluster algorithm improve speed detecting transitions (5/29/25) Adding documentation main algorithms (started: 5/29/25)","code":""}]
